(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/mine/mall/buy"],{"2bb5":function(t,e,s){"use strict";var i=s("e0ab"),a=s.n(i);a.a},3308:function(t,e,s){"use strict";s.r(e);var i=s("cf37"),a=s.n(i);for(var d in i)"default"!==d&&function(t){s.d(e,t,function(){return i[t]})}(d);e["default"]=a.a},"5abf":function(t,e,s){"use strict";s.r(e);var i=s("b80c"),a=s("3308");for(var d in a)"default"!==d&&function(t){s.d(e,t,function(){return a[t]})}(d);s("2bb5");var o=s("2877"),n=Object(o["a"])(a["default"],i["a"],i["b"],!1,null,null,null);e["default"]=n.exports},b80c:function(t,e,s){"use strict";var i=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("view",{staticClass:"buy-box"},[s("view",{staticClass:"addr-box"},[""==t.model?s("view",{staticClass:"no-addr",attrs:{eventid:"6cb651e3-0"},on:{click:t.showAddressListListener}},[s("view",{staticClass:"na-lt"},[t._v("选择收货地址")]),s("text",{staticClass:"iconfont icon-btn_arrowr"})]):t._e(),""!=t.model?s("view",{staticClass:"show-addr",attrs:{eventid:"6cb651e3-1"},on:{click:t.showAddressListListener}},[s("view",{staticClass:"lt-addr"},[s("view",{staticClass:"t-info"},[s("text",[t._v(t._s(t.model.name))]),s("text",[t._v(t._s(t.model.mobile))])]),s("view",{staticClass:"b-info"},[t._v(t._s(t.model.address))])]),s("text",{staticClass:"iconfont icon-btn_arrowr"})]):t._e()]),s("view",{staticClass:"item-goods"},[s("image",{staticClass:"g-img",attrs:{src:t.detail.photo}}),s("view",{staticClass:"g-cont"},[s("view",{staticClass:"gc-name ellipsis-1"},[t._v(t._s(t.detail.goods_name))]),t._m(0),s("view",{staticClass:"gc-price"},[s("text",{staticClass:"g-price"},[t._v(t._s(t.detail.integral))]),s("text",{staticClass:"g-markup"},[t._v("+"+t._s(t.detail.shop_price))])])])]),s("view",{staticClass:"order-info"},[s("view",{staticClass:"item-order"},[s("view",{staticClass:"o-lt"},[t._v("积分扣除")]),s("view",{staticClass:"o-rt"},[t._v(t._s(t.detail.integral)+"积分")])]),s("view",{staticClass:"item-order",staticStyle:{"border-bottom-width":"0"}},[s("view",{staticClass:"o-lt"},[t._v("运费")]),s("view",{staticClass:"o-rt"},[s("text",[t._v("¥"+t._s(t.detail.shipping_price))])])])]),s("view",{staticClass:"bottom-box"},[s("view",{staticClass:"bb-lt"},[s("text"),s("text",{staticClass:"bb-price"},[t._v(t._s(t.detail.integral))]),s("text",{staticClass:"bb-markup"},[t._v("+¥"+t._s(t.totalPrice))])]),s("view",{staticClass:"bb-rt",attrs:{eventid:"6cb651e3-2"},on:{click:t.showPaymentDialog}},[t._v("确认提交")])]),t.showAddressFlag?s("view",{staticClass:"mask"},[s("view",{staticClass:"dialog-address"},[s("view",{staticClass:"d-header"},[s("text",{staticStyle:{flex:"1"}},[t._v("选择收货地址")]),s("text",{staticClass:"iconfont icon-btn_close_black",staticStyle:{"padding-left":"15px"},attrs:{eventid:"6cb651e3-3"},on:{click:t.hideAddressListListener}})]),s("addressView",{attrs:{list:t.list,eventid:"6cb651e3-4",mpcomid:"6cb651e3-0"},on:{selectEvent:t.selectAddrListener,deleteEvent:t.deleteCallBack}})],1)]):t._e(),s("LoadingView",{attrs:{img:t.imgBaseUrl+"/loading.gif",mpcomid:"6cb651e3-1"}}),s("ToastView",{attrs:{mpcomid:"6cb651e3-2"}}),t.paymentFlag?s("view",{staticClass:"mask"},[s("view",{staticClass:"dialog-detailed"},[s("view",{staticClass:"dd-header"},[s("text",{staticClass:"h-tit"},[t._v("选择支付方式")]),s("text",{staticClass:"h-close iconfont icon-btn_close_black",attrs:{eventid:"6cb651e3-5"},on:{click:t.hidePaymentDialog}})]),s("view",{staticClass:"dd-payment"},[s("view",{staticClass:"item-payment",attrs:{"data-type":"weixin",eventid:"6cb651e3-6"},on:{click:t.paymentListener}},[t._m(1),s("text",{staticClass:"p-radio iconfont",class:"weixin"==t.pay_type?" icon-selector_enable":"icon-selector_disable",style:"color:"+("weixin"==t.pay_type?"#3A96E6":"#EDEDED")})]),s("view",{staticClass:"item-payment",attrs:{"data-type":"ali",eventid:"6cb651e3-7"},on:{click:t.paymentListener}},[t._m(2),s("text",{staticClass:"p-radio iconfont",class:"ali"==t.pay_type?" icon-selector_enable":"icon-selector_disable",style:"color:"+("ali"==t.pay_type?"#3A96E6":"#EDEDED")})])])])]):t._e()],1)},a=[function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("view",{staticClass:"gc-sku"},[s("text",[t._v("数量：")]),s("text",[t._v("x1")])])},function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("view",{staticClass:"p-lt"},[s("text",{staticClass:"iconfont icon-icon_pay_wepay",staticStyle:{"font-size":"30px",color:"#41B035"}}),s("text",{staticStyle:{color:"#333333","font-size":"16px","margin-left":"15px"}},[t._v("微信支付")])])},function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("view",{staticClass:"p-lt"},[s("text",{staticClass:"iconfont icon-icon_pay_alipay",staticStyle:{"font-size":"30px",color:"#00AAEE"}}),s("text",{staticStyle:{color:"#333333","font-size":"16px","margin-left":"15px"}},[t._v("支付宝支付")])])}];s.d(e,"a",function(){return i}),s.d(e,"b",function(){return a})},bb27:function(t,e,s){"use strict";s("2346");var i=d(s("b0ce")),a=d(s("5abf"));function d(t){return t&&t.__esModule?t:{default:t}}Page((0,i.default)(a.default))},cf37:function(t,e,s){"use strict";(function(t){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var i=a(s("0eb2"));function a(t){return t&&t.__esModule?t:{default:t}}var d={data:function(){return{goods_id:"",list:[],showAddressFlag:!1,model:"",detail:{},totalPrice:0,imgBaseUrl:"",paymentFlag:!1,pay_type:""}},created:function(){this.$data.imgBaseUrl=this.wxb.imgBaseUrl},onLoad:function(t){var e=this;e.wxb.addPage(this),e.wxb.Init(t,function(s){e.getDefaultAddress(),e.getAddressList(),void 0!=t.goods_id&&(e.$data.goods_id=t.goods_id)})},components:{addressView:i.default},onUnload:function(){this.wxb.removePage()},methods:{showPaymentDialog:function(e){this.$data.model&&this.$data.model.address_id?"h5"==this.wxb.device?this.$data.paymentFlag=!0:this.sureBuyListener():t.showToast({title:"请先选择收货地址"})},hidePaymentDialog:function(t){this.$data.paymentFlag=!1},paymentListener:function(t){var e=t.currentTarget.dataset.type;void 0!=e&&(this.$data.pay_type=e,this.sureBuyListener()),this.hidePaymentDialog()},sureBuyListener:function(e){var s=this;s.wxb.Post("/shop/api.integral/createOrder",{goods_id:s.$data.goods_id,address_id:s.$data.model.address_id,pay_type:"h5"==s.wxb.device?s.$data.pay_type:""},function(e){if(0==e.is_pay)t.redirectTo({url:"./order/detail?order_id="+e.order_id});else if("h5"==s.wxb.device)if("weixin"==s.$data.pay_type)console.log("h5端支付跳转超链接"),window.location.href=e.order_info;else{var i=window.document.createElement("div");i.innerHTML=e.order_info,window.document.body.appendChild(i),window.document.forms.alipaysubmit.submit()}else s.wxb.paymentOrder(e,function(s){console.log(e);e.order_id;t.redirectTo({url:"./order/detail?order_id="+e.order_id})})})},selectAddrListener:function(t){this.$data.model=JSON.parse(t),console.log(this.$data.model),this.getCheckOrderDetail(),this.hideAddressListListener()},showAddressListListener:function(){this.$data.showAddressFlag=!0},hideAddressListListener:function(){this.$data.showAddressFlag=!1,""==this.$data.model&&this.getDefaultAddress(),this.getAddressList()},deleteCallBack:function(t){this.getAddressList()},getDefaultAddress:function(t){var e=this;e.wxb.Post("/shop/api.address/getDefault",{},function(t){void 0!=t&&(e.$data.model=t),void 0!=e.$data.goods_id&&e.getCheckOrderDetail()})},getAddressList:function(t){var e=this;e.wxb.Post("/shop/api.address/getIndex",{},function(t){e.$data.list=t.list;var s=e.$data.model;for(var i in t.list)if(t.list[i].address_id==s.address_id)return;e.$data.model="",e.getDefaultAddress()})},getCheckOrderDetail:function(t){var e=this;e.wxb.Post("/shop/api.integral/orderConfirm",{goods_id:e.$data.goods_id,address_id:e.$data.model.address_id},function(t){e.$data.detail=t,e.$data.totalPrice=t.shipping_price-0+t.shop_price})}}};e.default=d}).call(this,s("543d")["default"])},e0ab:function(t,e,s){}},[["bb27","common/runtime","common/vendor"]]]);