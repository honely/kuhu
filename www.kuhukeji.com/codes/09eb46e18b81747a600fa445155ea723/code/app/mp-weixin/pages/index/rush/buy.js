(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/index/rush/buy"],{"11c3":function(t,e,s){"use strict";s("2346");var i=d(s("b0ce")),a=d(s("bd7c"));function d(t){return t&&t.__esModule?t:{default:t}}Page((0,i.default)(a.default))},"3df0":function(t,e,s){"use strict";var i=s("91ca"),a=s.n(i);a.a},6730:function(t,e,s){"use strict";(function(t){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var i=a(s("0eb2"));function a(t){return t&&t.__esModule?t:{default:t}}var d={data:function(){return{showAddressFlag:!1,model:{},list:[],goods:[],detail:{},detailedFlag:!1,detailedList:[],use_money:0,pay_type:"",paymentFlag:!1,spec_key:"",num:0,goods_id:"",goodsDetail:"",sku_desc:"",photo:"",price:"",payOrderId:"",imgBaseUrl:""}},created:function(){this.$data.imgBaseUrl=this.wxb.imgBaseUrl},onShow:function(){""!=this.$data.payOrderId&&setTimeout(function(){var e=this.$data.payOrderId;e&&t.redirectTo({url:"../../mine/order/detail?order_id="+e})},1e3)},onLoad:function(t){console.log(t);var e=this;e.wxb.addPage(this),e.wxb.Init(t,function(s){var i=t.goods_id,a=t.goodsNum,d=t.spec_key;e.$data.goods_id=i,e.$data.num=a,e.$data.spec_key=d,e.getDefaultAddress(),e.getAddressList()})},components:{addressView:i.default},onUnload:function(){this.wxb.removePage()},methods:{showPaymentDialog:function(t){"h5"==this.wxb.device?this.$data.paymentFlag=!0:this.sureBuyListener()},hidePaymentDialog:function(t){this.$data.paymentFlag=!1},paymentListener:function(t){var e=t.currentTarget.dataset.type;void 0!=e&&(this.$data.pay_type=e,this.sureBuyListener()),this.hidePaymentDialog()},showDetailedDialog:function(t){this.$data.detailedFlag=!0},hideDetailedDialog:function(t){this.$data.detailedFlag=!1},onUseMoneyListener:function(){0==this.$data.use_money?this.$data.use_money=1:this.$data.use_money=0},sureBuyListener:function(e){var s=this;s.wxb.Post("/shop/api.rushbuy/saveOrder",{rushbuy_goods_id:s.$data.goods_id,num:s.$data.num,spec_key:s.$data.spec_key,address_id:s.$data.model.address_id,use_money:s.$data.use_money,user_note:"",pay_type:"h5"==s.wxb.device?s.$data.pay_type:""},function(e){if(s.$data.pay_type="",0==e.is_pay)t.redirectTo({url:"../../mine/order/detail?order_id="+e.order_id});else if("h5"==s.wxb.device)if(s.$data.payOrderId=e.order_id,"weixin"==s.$data.pay_type)console.log("h5端支付跳转超链接"),window.location.href=e.order_info;else{var i=window.document.createElement("div");i.innerHTML=e.order_info,window.document.body.appendChild(i),window.document.forms.alipaysubmit.submit()}else s.wxb.paymentOrder(e,function(s){var i=e.order_id;t.redirectTo({url:"../../mine/order/detail?order_id="+i})})})},selectAddrListener:function(t){this.$data.list;this.$data.model=JSON.parse(t),console.log(this.$data.model),this.getCheckOrderDetail(),this.hideAddressListListener()},showAddressListListener:function(){this.$data.showAddressFlag=!0},hideAddressListListener:function(){this.$data.showAddressFlag=!1,""==this.$data.model&&this.getDefaultAddress(),this.getAddressList()},deleteCallBack:function(t){this.getAddressList()},getDefaultAddress:function(t){var e=this;e.wxb.Post("/shop/api.address/getDefault",{},function(t){void 0!=t&&(e.$data.model=t),void 0!=e.$data.model.address_id&&e.getCheckOrderDetail()})},getAddressList:function(t){var e=this;e.wxb.Post("/shop/api.address/getIndex",{},function(t){e.$data.list=t.list;var s=e.$data.model;for(var i in t.list)if(t.list[i].address_id==s.address_id)return;e.$data.model="",e.getDefaultAddress()})},getCheckOrderDetail:function(t){var e=this;e.wxb.Post("/shop/api.rushbuy/getPrice",{rushbuy_goods_id:e.$data.goods_id,address_id:e.$data.model.address_id,spec_key:e.$data.spec_key},function(t){e.$data.detail=t,e.$data.goods=[],e.$data.goods.push(t.goods),e.$data.goodsDetail=t.goods})}}};e.default=d}).call(this,s("543d")["default"])},"91ca":function(t,e,s){},aa8e:function(t,e,s){"use strict";s.r(e);var i=s("6730"),a=s.n(i);for(var d in i)"default"!==d&&function(t){s.d(e,t,function(){return i[t]})}(d);e["default"]=a.a},bd7c:function(t,e,s){"use strict";s.r(e);var i=s("dd1b"),a=s("aa8e");for(var d in a)"default"!==d&&function(t){s.d(e,t,function(){return a[t]})}(d);s("3df0");var o=s("2877"),l=Object(o["a"])(a["default"],i["a"],i["b"],!1,null,null,null);e["default"]=l.exports},dd1b:function(t,e,s){"use strict";var i=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("view",{staticClass:"buy-box"},[s("view",{staticStyle:{position:"absolute",top:"0",bottom:"60px",left:"0",right:"0",overflow:"scroll"}},[s("view",{staticClass:"addr-box"},[""==t.model?s("view",{staticClass:"no-addr",attrs:{eventid:"e0b8df60-0"},on:{click:t.showAddressListListener}},[s("view",{staticClass:"na-lt"},[t._v("选择收货地址")]),s("text",{staticClass:"iconfont icon-btn_arrowr"})]):t._e(),""!=t.model?s("view",{staticClass:"show-addr",attrs:{eventid:"e0b8df60-1"},on:{click:t.showAddressListListener}},[s("view",{staticClass:"lt-addr"},[s("view",{staticClass:"t-info"},[s("text",[t._v(t._s(t.model.name))]),s("text",[t._v(t._s(t.model.mobile))])]),s("view",{staticClass:"b-info"},[t._v(t._s(t.model.address))])]),s("text",{staticClass:"iconfont icon-btn_arrowr"})]):t._e()]),s("view",{staticClass:"item-goods",staticStyle:{"'margin-top":"12px"}},[s("image",{staticClass:"g-img",attrs:{src:t.goodsDetail&&t.goodsDetail.photo?t.goodsDetail.photo:""}}),s("view",{staticClass:"g-cont"},[s("view",{staticClass:"gc-name ellipsis-1"},[t._v(t._s(t.goodsDetail&&t.goodsDetail.goods_name?t.goodsDetail.goods_name:""))]),s("view",{staticClass:"gc-sku"},[s("view",{staticClass:"sku-cont ellipsis-02"},[t._v(t._s(t.goodsDetail&&t.goodsDetail.spec_key_name?t.goodsDetail.spec_key_name:""))]),s("text",[t._v("x"+t._s(t.num))])]),s("view",{staticClass:"gc-price"},[s("text",{staticClass:"g-price"},[t._v("¥"+t._s(t.goodsDetail&&t.goodsDetail.qg_price?t.goodsDetail.qg_price:"0.00"))])])])]),s("view",{staticClass:"order-info"},[s("view",{staticClass:"item-order"},[s("view",{staticClass:"o-lt"},[t._v("商品总额")]),s("view",{staticClass:"o-rt"},[t._v(t._s(t.detail.total_price))])]),s("view",{staticClass:"item-order",staticStyle:{"border-bottom-width":"0"}},[s("view",{staticClass:"o-lt"},[t._v("运费")]),s("view",{staticClass:"o-rt"},[s("text",[t._v("¥"+t._s(t.detail.freight))])])])]),s("view",{staticClass:"order-info"},[s("view",{staticClass:"item-order",staticStyle:{"border-bottom-width":"0"}},[s("view",{staticClass:"o-lt"},[t._v("是否使用余额支付")]),s("view",{staticClass:"o-rt"},[s("text",{staticClass:"iconfont icon-radio",class:1==t.use_money?"icon-selector_enable1 ":"icon-selector_disable1 ",style:"color:"+(1==t.use_money?"#ED3005":"#999999")+";",attrs:{eventid:"e0b8df60-2"},on:{click:t.onUseMoneyListener}})])])])]),s("view",{staticClass:"bottom-box"},[s("view",{staticClass:"bb-lt"},[s("text",{staticClass:"bb-price"},[t._v("¥"+t._s(t.detail.need_price))]),s("view",{staticClass:"bb-detailed",attrs:{eventid:"e0b8df60-3"},on:{click:t.showDetailedDialog}},[s("text",[t._v("明细")]),s("text",{staticClass:"iconfont icon-icon_arrowdown1"})])]),s("view",{staticClass:"bb-rt",attrs:{eventid:"e0b8df60-4"},on:{click:t.showPaymentDialog}},[t._v("结算("+t._s(t.num)+")")])]),t.showAddressFlag?s("view",{staticClass:"mask"},[s("view",{staticClass:"dialog-address"},[s("view",{staticClass:"d-header"},[s("text",{staticStyle:{flex:"1"}},[t._v("选择收货地址")]),s("text",{staticClass:"iconfont icon-btn_close_black",staticStyle:{"padding-left":"15px"},attrs:{eventid:"e0b8df60-5"},on:{click:t.hideAddressListListener}})]),s("addressView",{attrs:{list:t.list,eventid:"e0b8df60-6",mpcomid:"e0b8df60-0"},on:{selectEvent:t.selectAddrListener,deleteEvent:t.deleteCallBack}})],1)]):t._e(),s("LoadingView",{attrs:{img:t.imgBaseUrl+"/loading.gif",mpcomid:"e0b8df60-1"}}),s("ToastView",{attrs:{mpcomid:"e0b8df60-2"}}),t.paymentFlag?s("view",{staticClass:"mask"},[s("view",{staticClass:"dialog-detailed"},[s("view",{staticClass:"dd-header"},[s("text",{staticClass:"h-tit"},[t._v("选择支付方式")]),s("text",{staticClass:"h-close iconfont icon-btn_close_black",attrs:{eventid:"e0b8df60-7"},on:{click:t.hidePaymentDialog}})]),s("view",{staticClass:"dd-payment"},[s("view",{staticClass:"item-payment",attrs:{"data-type":"weixin",eventid:"e0b8df60-8"},on:{click:t.paymentListener}},[t._m(0),s("text",{staticClass:"p-radio iconfont",class:"weixin"==t.pay_type?" icon-selector_enable":"icon-selector_disable",style:"color:"+("weixin"==t.pay_type?"#3A96E6":"#EDEDED")})]),s("view",{staticClass:"item-payment",attrs:{"data-type":"ali",eventid:"e0b8df60-9"},on:{click:t.paymentListener}},[t._m(1),s("text",{staticClass:"p-radio iconfont",class:"ali"==t.pay_type?" icon-selector_enable":"icon-selector_disable",style:"color:"+("ali"==t.pay_type?"#3A96E6":"#EDEDED")})])])])]):t._e(),t.detailedFlag?s("view",{staticClass:"mask"},[s("view",{staticClass:"dialog-detailed"},[s("view",{staticClass:"dd-header"},[s("text",{staticClass:"h-tit"},[t._v("商品费用明细")]),s("text",{staticClass:"h-close iconfont icon-btn_close_black",attrs:{eventid:"e0b8df60-10"},on:{click:t.hideDetailedDialog}})]),s("view",{staticClass:"dd-cont"},[t._l(t.detailedList,function(e,i){return s("view",{key:i,staticClass:"item-dcont"},[s("view",{staticClass:"d-name"},[t._v(t._s(e.goods_name))]),s("view",{staticClass:"d-detail"},[s("view",{staticClass:"lt"},[s("text",[t._v("¥"+t._s(e.shop_price)+" x "+t._s(t.num))]),e.zhe?s("text",{staticClass:"zhe"},[t._v(t._s(e.zhe)+"折")]):t._e()]),s("view",{staticClass:"rt"},[t._v("¥"+t._s(e.zhe?e.dPrice/100:e.shop_price*t.num))])])])}),s("view",{staticClass:"item-detail"},[s("view",{staticClass:"d-lt"},[t._v("运费")]),s("view",{staticClass:"d-rt"},[t._v("¥"+t._s(t.detail.freight))])]),s("view",{staticClass:"item-detail"},[s("view",{staticClass:"d-lt"},[t._v("总额")]),s("view",{staticClass:"d-rt",staticStyle:{color:"#ED3005"}},[s("text",[t._v("¥")]),s("text",[t._v(t._s(t.detail.total_price))])])])],2)])]):t._e()],1)},a=[function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("view",{staticClass:"p-lt"},[s("text",{staticClass:"iconfont icon-icon_pay_wepay",staticStyle:{"font-size":"30px",color:"#41B035"}}),s("text",{staticStyle:{color:"#333333","font-size":"16px","margin-left":"15px"}},[t._v("微信支付")])])},function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("view",{staticClass:"p-lt"},[s("text",{staticClass:"iconfont icon-icon_pay_alipay",staticStyle:{"font-size":"30px",color:"#00AAEE"}}),s("text",{staticStyle:{color:"#333333","font-size":"16px","margin-left":"15px"}},[t._v("支付宝支付")])])}];s.d(e,"a",function(){return i}),s.d(e,"b",function(){return a})}},[["11c3","common/runtime","common/vendor"]]]);