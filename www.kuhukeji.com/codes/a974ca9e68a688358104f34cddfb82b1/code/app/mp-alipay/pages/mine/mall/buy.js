(my["webpackJsonp"]=my["webpackJsonp"]||[]).push([["pages/mine/mall/buy"],{"2bb5":function(t,s,i){"use strict";var e=i("e0ab"),a=i.n(e);a.a},3308:function(t,s,i){"use strict";i.r(s);var e=i("cf37"),a=i.n(e);for(var d in e)"default"!==d&&function(t){i.d(s,t,function(){return e[t]})}(d);s["default"]=a.a},"5abf":function(t,s,i){"use strict";i.r(s);var e=i("b80c"),a=i("3308");for(var d in a)"default"!==d&&function(t){i.d(s,t,function(){return a[t]})}(d);i("2bb5");var r=i("2877"),o=Object(r["a"])(a["default"],e["a"],e["b"],!1,null,null,null);s["default"]=o.exports},b80c:function(t,s,i){"use strict";var e=function(){var t=this,s=t.$createElement,i=t._self._c||s;return i("view",{staticClass:"buy-box",attrs:{_hid:0}},[i("view",{staticClass:"addr-box",attrs:{_hid:1}},[t._ri(!(""!=t.model),2)?i("view",{staticClass:"no-addr",attrs:{_hid:2},on:{click:t.showAddressListListener}},[i("view",{staticClass:"na-lt",attrs:{_hid:3}},[]),i("text",{staticClass:"iconfont icon-btn_arrowr",attrs:{_hid:5}})]):t._e(),t._ri(!(""==t.model),6)?i("view",{staticClass:"show-addr",attrs:{_hid:6},on:{click:t.showAddressListListener}},[i("view",{staticClass:"lt-addr",attrs:{_hid:7}},[i("view",{staticClass:"t-info",attrs:{_hid:8}},[i("text",{attrs:{_hid:9}},[t._v(t._s(t.model.name),10)]),i("text",{attrs:{_hid:11}},[t._v(t._s(t.model.mobile),12)])]),i("view",{staticClass:"b-info",attrs:{_hid:13}},[t._v(t._s(t.model.address),14)])]),i("text",{staticClass:"iconfont icon-btn_arrowr",attrs:{_hid:15}})]):t._e()]),i("view",{staticClass:"item-goods",attrs:{_hid:16}},[i("image",{staticClass:"g-img",attrs:{src:t.detail.photo,_hid:17,_batrs:"src"}}),i("view",{staticClass:"g-cont",attrs:{_hid:18}},[i("view",{staticClass:"gc-name ellipsis-1",attrs:{_hid:19}},[t._v(t._s(t.detail.goods_name),20)]),t._m(0),i("view",{staticClass:"gc-price",attrs:{_hid:26}},[i("text",{staticClass:"g-price",attrs:{_hid:27}},[t._v(t._s(t.detail.integral),28)]),i("text",{staticClass:"g-markup",attrs:{_hid:29}},[t._v("+"+t._s(t.detail.shop_price),30)])])])]),i("view",{staticClass:"order-info",attrs:{_hid:31}},[i("view",{staticClass:"item-order",attrs:{_hid:32}},[i("view",{staticClass:"o-lt",attrs:{_hid:33}},[]),i("view",{staticClass:"o-rt",attrs:{_hid:35}},[t._v(t._s(t.detail.integral)+"积分",36)])]),i("view",{staticClass:"item-order",staticStyle:{"border-bottom-width":"0"},attrs:{_hid:37}},[i("view",{staticClass:"o-lt",attrs:{_hid:38}},[]),i("view",{staticClass:"o-rt",attrs:{_hid:40}},[i("text",{attrs:{_hid:41}},[t._v("¥"+t._s(t.detail.shipping_price),42)])])])]),i("view",{staticClass:"bottom-box",attrs:{_hid:43}},[i("view",{staticClass:"bb-lt",attrs:{_hid:44}},[i("text",{attrs:{_hid:45}}),i("text",{staticClass:"bb-price",attrs:{_hid:46}},[t._v(t._s(t.detail.integral),47)]),i("text",{staticClass:"bb-markup",attrs:{_hid:48}},[t._v("+¥"+t._s(t.totalPrice),49)])]),i("view",{staticClass:"bb-rt",attrs:{_hid:50},on:{click:t.showPaymentDialog}},[])]),t._ri(!!t.showAddressFlag,52)?i("view",{staticClass:"mask",attrs:{_hid:52}},[i("view",{staticClass:"dialog-address",attrs:{_hid:53}},[i("view",{staticClass:"d-header",attrs:{_hid:54}},[i("text",{staticStyle:{flex:"1"},attrs:{_hid:55}},[]),i("text",{staticClass:"iconfont icon-btn_close_black",staticStyle:{"padding-left":"15px"},attrs:{_hid:57},on:{click:t.hideAddressListListener}})]),i("addressView",{attrs:{list:t.list,_hid:58,_batrs:"list",_cid:0},on:{selectEvent:t.selectAddrListener,deleteEvent:t.deleteCallBack}})],1)]):t._e(),i("LoadingView",{attrs:{img:t.imgBaseUrl+"/loading.gif",_hid:1060,_batrs:"img",_cid:1}}),i("ToastView",{attrs:{_hid:2062,_cid:2}}),t._ri(!!t.paymentFlag,3064)?i("view",{staticClass:"mask",attrs:{_hid:3064}},[i("view",{staticClass:"dialog-detailed",attrs:{_hid:3065}},[i("view",{staticClass:"dd-header",attrs:{_hid:3066}},[i("text",{staticClass:"h-tit",attrs:{_hid:3067}},[]),i("text",{staticClass:"h-close iconfont icon-btn_close_black",attrs:{_hid:3069},on:{click:t.hidePaymentDialog}})]),i("view",{staticClass:"dd-payment",attrs:{_hid:3070}},[i("view",{staticClass:"item-payment",attrs:{"data-type":"weixin",_hid:3071},on:{click:t.paymentListener}},[t._m(1),i("text",{staticClass:"p-radio iconfont",class:"weixin"==t.pay_type?" icon-selector_enable":"icon-selector_disable",style:"color:"+("weixin"==t.pay_type?"#3A96E6":"#EDEDED"),attrs:{_hid:3076}})]),i("view",{staticClass:"item-payment",attrs:{"data-type":"ali",_hid:3077},on:{click:t.paymentListener}},[t._m(2),i("text",{staticClass:"p-radio iconfont",class:"ali"==t.pay_type?" icon-selector_enable":"icon-selector_disable",style:"color:"+("ali"==t.pay_type?"#3A96E6":"#EDEDED"),attrs:{_hid:3082}})])])])]):t._e()],1)},a=[function(){var t=this,s=t.$createElement,i=t._self._c||s;return i("view",{staticClass:"gc-sku",attrs:{_hid:21}},[i("text",{attrs:{_hid:22}},[]),i("text",{attrs:{_hid:24}},[])])},function(){var t=this,s=t.$createElement,i=t._self._c||s;return i("view",{staticClass:"p-lt",attrs:{_hid:3072}},[i("text",{staticClass:"iconfont icon-icon_pay_wepay",staticStyle:{"font-size":"30px",color:"#41B035"},attrs:{_hid:3073}}),i("text",{staticStyle:{color:"#333333","font-size":"16px","margin-left":"15px"},attrs:{_hid:3074}},[])])},function(){var t=this,s=t.$createElement,i=t._self._c||s;return i("view",{staticClass:"p-lt",attrs:{_hid:3078}},[i("text",{staticClass:"iconfont icon-icon_pay_alipay",staticStyle:{"font-size":"30px",color:"#00AAEE"},attrs:{_hid:3079}}),i("text",{staticStyle:{color:"#333333","font-size":"16px","margin-left":"15px"},attrs:{_hid:3080}},[])])}];i.d(s,"a",function(){return e}),i.d(s,"b",function(){return a})},bb27:function(t,s,i){"use strict";i("2346");var e=d(i("5abf")),a=d(i("3a53"));function d(t){return t&&t.__esModule?t:{default:t}}e.default.mpType="page";var r=new a.default(e.default);r.$mount()},cf37:function(t,s,i){"use strict";(function(t){Object.defineProperty(s,"__esModule",{value:!0}),s.default=void 0;var e=a(i("0eb2"));function a(t){return t&&t.__esModule?t:{default:t}}var d={data:function(){return{goods_id:"",list:[],showAddressFlag:!1,model:"",detail:{},totalPrice:0,imgBaseUrl:"",paymentFlag:!1,pay_type:""}},created:function(){this.$data.imgBaseUrl=this.wxb.imgBaseUrl},onLoad:function(t){var s=this;s.wxb.addPage(this),s.wxb.Init(t,function(i){s.getDefaultAddress(),s.getAddressList(),void 0!=t.goods_id&&(s.$data.goods_id=t.goods_id)})},components:{addressView:e.default},onUnload:function(){this.wxb.removePage()},methods:{showPaymentDialog:function(s){this.$data.model&&this.$data.model.address_id?"h5"==this.wxb.device?this.$data.paymentFlag=!0:this.sureBuyListener():t.showToast({title:"请先选择收货地址"})},hidePaymentDialog:function(t){this.$data.paymentFlag=!1},paymentListener:function(t){var s=t.currentTarget.dataset.type;void 0!=s&&(this.$data.pay_type=s,this.sureBuyListener()),this.hidePaymentDialog()},sureBuyListener:function(s){var i=this;i.wxb.Post("/shop/api.integral/createOrder",{goods_id:i.$data.goods_id,address_id:i.$data.model.address_id,pay_type:"h5"==i.wxb.device?i.$data.pay_type:""},function(s){if(0==s.is_pay)t.redirectTo({url:"./order/detail?order_id="+s.order_id});else if("h5"==i.wxb.device)if("weixin"==i.$data.pay_type)console.log("h5端支付跳转超链接"),window.location.href=s.order_info;else{var e=window.document.createElement("div");e.innerHTML=s.order_info,window.document.body.appendChild(e),window.document.forms.alipaysubmit.submit()}else i.wxb.paymentOrder(s,function(i){console.log(s);s.order_id;t.redirectTo({url:"./order/detail?order_id="+s.order_id})})})},selectAddrListener:function(t){this.$data.model=JSON.parse(t),console.log(this.$data.model),this.getCheckOrderDetail(),this.hideAddressListListener()},showAddressListListener:function(){this.$data.showAddressFlag=!0},hideAddressListListener:function(){this.$data.showAddressFlag=!1,""==this.$data.model&&this.getDefaultAddress(),this.getAddressList()},deleteCallBack:function(t){this.getAddressList()},getDefaultAddress:function(t){var s=this;s.wxb.Post("/shop/api.address/getDefault",{},function(t){void 0!=t&&(s.$data.model=t),void 0!=s.$data.goods_id&&s.getCheckOrderDetail()})},getAddressList:function(t){var s=this;s.wxb.Post("/shop/api.address/getIndex",{},function(t){s.$data.list=t.list;var i=s.$data.model;for(var e in t.list)if(t.list[e].address_id==i.address_id)return;s.$data.model="",s.getDefaultAddress()})},getCheckOrderDetail:function(t){var s=this;s.wxb.Post("/shop/api.integral/orderConfirm",{goods_id:s.$data.goods_id,address_id:s.$data.model.address_id},function(t){s.$data.detail=t,s.$data.totalPrice=t.shipping_price-0+t.shop_price})}}};s.default=d}).call(this,i("c11b")["default"])},e0ab:function(t,s,i){}},[["bb27","common/runtime","common/vendor"]]]);