(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/mine/order/refund/index"],{"0c6f":function(t,e,s){},"1aca":function(t,e,s){"use strict";var a=s("0c6f"),i=s.n(a);i.a},"487c":function(t,e,s){"use strict";s.r(e);var a=s("c19d"),i=s("5efb");for(var o in i)"default"!==o&&function(t){s.d(e,t,function(){return i[t]})}(o);s("1aca");var n=s("2877"),r=Object(n["a"])(i["default"],a["a"],a["b"],!1,null,null,null);e["default"]=r.exports},"5efb":function(t,e,s){"use strict";s.r(e);var a=s("cd8c"),i=s.n(a);for(var o in a)"default"!==o&&function(t){s.d(e,t,function(){return a[t]})}(o);e["default"]=i.a},"61e2":function(t,e,s){"use strict";s("2346");var a=o(s("b0ce")),i=o(s("487c"));function o(t){return t&&t.__esModule?t:{default:t}}Page((0,a.default)(i.default))},c19d:function(t,e,s){"use strict";var a=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("view",{staticClass:"refund-box"},[s("view",{staticClass:"refund-cont"},[t._l(t.detail.order_goods,function(e,a){return s("view",{key:a,staticClass:"goods-base"},[s("image",{staticClass:"g-img",attrs:{src:e.goods_photo}}),s("view",{staticClass:"g-info"},[s("view",{staticClass:"gi-name ellipsis-02"},[t._v(t._s(e.goods_name))]),s("view",{staticClass:"gi-sku"},[s("view",{staticClass:"sku-desc"},[t._v(t._s(e.spec_key_name))]),s("view",{staticClass:"goods-num"},[t._v("x"+t._s(e.goods_num))])])])])}),s("view",{staticClass:"refund-desc"},[s("view",{staticClass:"item-refund",attrs:{eventid:"3a580f18-0"},on:{click:t.showOrderStateDialog}},[s("view",{staticClass:"ir-lt"},[t._v("货物状态")]),s("view",{staticClass:"ir-rt"},[s("text",{staticStyle:{color:"#000"}},[t._v(t._s(0==t.stateIndex?"未收到货":"已收到货"))]),s("text",{staticClass:"iconfont icon-btn_arrowr"})])]),s("view",{staticClass:"item-refund",staticStyle:{"border-bottom-width":"0"},attrs:{eventid:"3a580f18-1"},on:{click:t.showOrderReasonDialog}},[s("view",{staticClass:"ir-lt"},[t._v("退款原因")]),s("view",{staticClass:"ir-rt"},[s("text",{style:"color:"+(""==t.resonDesc?"":"#000;")},[t._v(t._s(""==t.resonDesc?"请选择":t.resonDesc))]),s("text",{staticClass:"iconfont icon-btn_arrowr"})])])]),s("view",{staticClass:"refund-money"},[s("view",{staticClass:"rm-lt"},[t._v("退款金额")]),s("view",{staticClass:"rm-rt"},[t._v("¥"+t._s(t.detail.final_price))])]),s("view",{staticClass:"shopping-num"},[t._v("含发货运费¥"+t._s(t.detail.shipping_price))]),s("view",{staticClass:"reason-cont"},[s("textarea",{staticClass:"rc-area",attrs:{placeholder:"退款说明（选填）",eventid:"3a580f18-2"},on:{input:t.reasonChangeListener}})]),s("view",{staticClass:"reason-img"},[s("view",{staticClass:"ri-tit"},[t._v("上传凭证")]),s("view",{staticClass:"ri-cont"},[t._l(t.list,function(e,a){return s("view",{key:a,staticClass:"model-img"},[s("image",{staticStyle:{width:"100%",height:"100%"},attrs:{src:e}}),s("image",{staticClass:"iv-delete",attrs:{src:t.imgBaseUrl+"/order/btn_deletePhoto@3x.png",eventid:"3a580f18-3-"+a},on:{click:function(e){t.deletePhotoListener(a)}}})])}),t.list.length<6?s("view",{staticClass:"model-img"},[s("view",{staticClass:"add-img",attrs:{eventid:"3a580f18-4"},on:{click:t.addPhotoListener}},[s("view",{staticClass:"iconfont icon-btn_photo",staticStyle:{"font-size":"24px"}}),s("view",{staticStyle:{"margin-top":"10px"}},[t._v("添加图片")])])]):t._e()],2)]),s("view",{staticStyle:{width:"100%",height:"70px"}}),s("view",{staticClass:"bottom-box"},[s("button",{staticClass:"btn-submit",attrs:{eventid:"3a580f18-5"},on:{click:t.submitApplyListener}},[t._v("提交")])],1)],2),t.stateFlag?s("view",{staticClass:"mask"},[s("view",{staticClass:"dialog-box"},[s("view",{staticClass:"dialog-detailed db-header"},[s("view",{staticClass:"h-lt"},[t._v("选择货物状态")]),s("view",{staticClass:"h-rt iconfont icon-btn_close_black",attrs:{eventid:"3a580f18-6"},on:{click:t.hideOrderStateDialog}})]),s("view",{staticClass:"db-cont"},[s("view",{staticClass:"item-options"},[s("view",{staticClass:"io-lt"},[t._v("未收到货")]),s("view",{staticClass:"io-rt iconfont",class:0==t.stateIndex?"icon-selector_enable":"icon-selector_disable",style:"color:"+(0==t.stateIndex?"#ED3005;":"#CCCCCC;"),attrs:{eventid:"3a580f18-7"},on:{click:function(e){t.radioStateListener(0)}}})]),s("view",{staticClass:"item-options"},[s("view",{staticClass:"io-lt"},[t._v("已收到货")]),s("view",{staticClass:"io-rt iconfont",class:1==t.stateIndex?"icon-selector_enable":"icon-selector_disable",style:"color:"+(1==t.stateIndex?"#ED3005;":"#CCCCCC;"),attrs:{eventid:"3a580f18-8"},on:{click:function(e){t.radioStateListener(1)}}})])])])]):t._e(),t.reasonFlag?s("view",{staticClass:"mask"},[s("view",{staticClass:"dialog-box"},[s("view",{staticClass:"db-header"},[s("view",{staticClass:"h-lt"},[t._v("选择退款原因")]),s("view",{staticClass:"h-rt iconfont icon-btn_close_black",attrs:{eventid:"3a580f18-9"},on:{click:t.hideOrderReasonDialog}})]),s("view",{staticClass:"db-cont",staticStyle:{height:"700px"}},t._l(t.reasonList,function(e,a){return s("view",{key:a,staticClass:"item-options"},[s("view",{staticClass:"io-lt"},[t._v(t._s(e.value))]),s("view",{staticClass:"io-rt iconfont",class:t.reasonIndex==e.key?"icon-selector_enable":"icon-selector_disable",style:"color:"+(t.reasonIndex==e.key?"#ED3005;":"#CCCCCC;"),attrs:{eventid:"3a580f18-10-"+a},on:{click:function(s){t.radioReasonListener(e)}}})])}))])]):t._e()])},i=[];s.d(e,"a",function(){return a}),s.d(e,"b",function(){return i})},cd8c:function(t,e,s){"use strict";(function(t){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var s={data:function(){return{stateFlag:!1,stateIndex:0,reasonFlag:!1,reasonIndex:0,resonDesc:"",order_id:"",detail:"",list:[],reasonData:"",reasonList:[],resonCont:"",imgBaseUrl:""}},created:function(){this.$data.imgBaseUrl=this.wxb.imgBaseUrl},onLoad:function(t){var e=this;e.wxb.printLog(t),e.wxb.addPage(this),e.wxb.Init(t,function(s){t.order_id&&(e.$data.order_id=t.order_id,e.getOrderDetail(),e.getApplyRefund())})},onUnload:function(){this.wxb.removePage()},methods:{getApplyRefund:function(t){var e=this;e.wxb.Post("/shop/api.order/applyRefund",{order_id:e.$data.order_id},function(t){console.log(t),e.$data.reasonData=t,0==e.$data.stateIndex?e.$data.reasonList=t.no_goods_reject_reason:e.$data.reasonList=t.has_goods_reject_reason})},reasonChangeListener:function(t){var e=t.detail.value;this.$data.resonCont=e},addPhotoListener:function(e){var s=this;s.$data.list.length<6&&t.chooseImage({count:1,sizeType:["compressed"],success:function(e){console.log(e),t.uploadFile({url:s.wxb.shopUrl+"/shop/api.upload/imageUpload",fileType:"image",filePath:e.tempFilePaths[0],name:"file",success:function(e){var a=JSON.parse(e.data);console.log(a),200==e.statusCode&&200==a.code?(s.$data.list.push(a.data.img_url),console.log(s.$data.list)):t.showModal({title:"提示",content:"上传失败",showCancel:!1})},fail:function(e){t.showModal({title:"提示",content:"上传失败",showCancel:!1})},complete:function(){t.hideToast()}})}})},submitApplyListener:function(e){var s=this;s.wxb.Post("/shop/api.order/applyRefundSub",{order_id:s.$data.order_id,reject_goods_status:s.$data.stateIndex,reject_reason:s.$data.reasonIndex,reject_content:s.$data.resonCont,reject_photos:JSON.stringify(s.$data.list)},function(e){t.showToast({title:"提交成功",duration:2e3}),setTimeout(function(){t.navigateTo({url:"/pages/mine/order/index"})},3e3)})},deletePhotoListener:function(t){var e=this.$data.list;e.splice(t,1),this.$data.list=e},radioStateListener:function(t){this.$data.stateIndex=t,this.$data.reasonList=0==t?this.reasonData.no_goods_reject_reason:this.reasonData.has_goods_reject_reason},showOrderStateDialog:function(t){this.$data.stateFlag=!0},hideOrderStateDialog:function(t){this.$data.stateFlag=!1},radioReasonListener:function(t){this.$data.reasonIndex=t.key,this.$data.resonDesc=t.value,this.hideOrderReasonDialog()},showOrderReasonDialog:function(t){this.$data.reasonFlag=!0},hideOrderReasonDialog:function(t){this.$data.reasonFlag=!1},getOrderDetail:function(t){var e=this;e.wxb.Post("/shop/api.order/getDetail",{order_id:e.$data.order_id},function(t){e.$data.detail=t})}}};e.default=s}).call(this,s("543d")["default"])}},[["61e2","common/runtime","common/vendor"]]]);