(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/index/bargain/detail"],{"38bd":function(t,e,a){"use strict";(function(t){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var i=d(a("540a")),s=d(a("8972")),o=d(a("9219")),n=d(a("0eb2"));function d(t){return t&&t.__esModule?t:{default:t}}var c={data:function(){return{userid:0,hour:0,minute:0,second:0,bargain_id:"",detail:"",index:0,tabBars:[{name:"商品",id:"0"},{name:"评价",id:"1"},{name:"推荐",id:"2"}],tData:{type:1,pbottom:0,ptop:22,mtop:0,data:{icon:"icon_quan",title:"领取优惠券"}},currIndex:1,kan_surplus_time:0,specs:[],skuFlag:!1,buyType:0,goodsNum:0,sku:"",address_id:"",addressFlag:!1,list:[],comment_type:1,comment:[],more:0,page:1,likes:[],likePage:1,likeMore:0,imgBaseUrl:"",customerNum:""}},components:{skuDialog:i.default,goodsDescribe:s.default,uniCountdown:o.default,addressView:n.default},created:function(){this.$data.imgBaseUrl=this.wxb.imgBaseUrl},onLoad:function(e){var a=this,i=t.getStorageSync("user_id");void 0!=i&&""!=i&&(a.$data.userid=i),void 0!=e.pid&&""!=e.pid&&t.setStorageSync("pid",e.pid),a.wxb.printLog("=============onLoad================"),a.wxb.addPage(this),a.wxb.Init(e,function(t){a.$data.customerNum=t.info.tel,void 0!=e.id&&(a.$data.bargain_id=e.id),a.getBargainDetail(),a.getAddressList()})},onUnload:function(){this.wxb.printLog("=============onUnload================"),this.wxb.removePage()},onShareAppMessage:function(){var t=this;return{title:t.$data.detail&&""!=t.$data.detail.goods_name?t.$data.detail.goods_name:"商品详情",path:"/pages/index/bargain/detail?id="+t.$data.bargain_id+"&pid="+t.$data.userid}},methods:{toCallPhone:function(e){var a=this,i=a.$data.customerNum;""!=i?t.makePhoneCall({phoneNumber:i}):t.showToast({title:"请先配置"})},toHomeListener:function(e){t.reLaunch({url:"/pages/index/index"})},getLikeGoodsList:function(){var t=this,e=t.$data.likePage,a=t.$data.likes;1==e&&(a=[]),t.$data.detail&&t.wxb.Post("/shop/api.goods/index",{page:t.$data.likePage,p_cat_id:0},function(e){for(var i in e.list)a.push(e.list[i]);t.$data.likes=a,t.$data.likePage+=1,t.$data.likeMore=e.isMore})},showSkuDialogListener:function(t){this.$data.skuFlag=!0},hideSkuDialogListener:function(t){this.$data.skuFlag=!1},buyGoodsListener:function(e){t.redirectTo({url:"../goods/detail?goods_id="+this.$data.detail.goods_id})},bargainGoodsListener:function(e){if(1==this.$data.detail.is_kan&&0==this.$data.detail.is_kan)t.navigateTo({url:"join?bargain_item_id="+this.$data.detail.bargain_item_id+"&kan_price=0"});else{var a=this;a.showSkuDialogListener(),this.$data.buyType=1}},sureSelectGoodsListener:function(t){var e=this;if(0==e.$data.buyType);else if(1==e.$data.buyType){console.log(t);var a=t.detail,i=a.goodsNum,s=a.sku;this.$data.goodsNum=i,this.$data.sku=s,this.hideSkuDialogListener(),this.showAddressDialogListener()}},getAddressList:function(t){var e=this;e.wxb.Post("/shop/api.address/getIndex",{},function(t){e.$data.list=t.list})},showAddressDialogListener:function(t){this.$data.addressFlag=!0},hideAddressDialogListener:function(t){this.$data.addressFlag=!1},selectAddrListener:function(t){console.log("确定选择的地址");var e=this,a=(t=JSON.parse(t),t.address_id);e.$data.address_id=a,e.hideAddressDialogListener(),e.openBargain()},openBargain:function(e){var a=this;a.wxb.Post("/shop/api.bargain/openBargain",{bargain_id:a.$data.bargain_id,spec_key:a.$data.sku,address_id:a.$data.address_id},function(e){a.getBargainDetail(),t.navigateTo({url:"join?bargain_item_id="+e.bargain_item_id+"&kan_price="+e.kan_price})})},bannerChangeListener:function(t){this.$data.currIndex=t.detail.current+1},commentTypeListener:function(t){var e=t.currentTarget.dataset.type;this.$data.comment_type=e,this.$data.page=1,this.getBargainDetail()},getBargainDetail:function(t){var e=this,a=e.$data.comment,i=e.$data.page;1==i&&(a=[]),e.wxb.Post("/shop/api.bargain/detail",{bargain_id:e.$data.bargain_id,comment_type:e.$data.comment_type,page:e.$data.page},function(t){for(var s in t.comment.comment)a.push(t.comment.comment[s]);if(1==i){e.$data.detail=t.detail,e.$data.kan_surplus_time=t.detail.kan_surplus_time;var o=e.$data.kan_surplus_time,n=o/3600|0,d=(Math.round(o)-3600*n)/60|0;o=o%60|0;e.$data.hour=n,e.$data.minute=d,e.$data.second=o;var c=[];for(var l in t.detail.spec){var r=[];for(var s in t.detail.spec[l])t.detail.spec[l][s].select="item-spec-nor",r.push(t.detail.spec[l][s]);c.push({name:l,list:r})}e.$data.specs=c,e.wxb.printLog(c)}e.$data.isMore=t.comment.isMore,e.$data.comment=a,e.$data.page+=1})},tapTab:function(t){this.$data.index=t,2==t&&(this.$data.likePage=1,this.getLikeGoodsList())},catchTouchMove:function(t){}}};e.default=c}).call(this,a("543d")["default"])},"4e3a":function(t,e,a){"use strict";var i=a("d36a"),s=a.n(i);s.a},"71af":function(t,e,a){"use strict";a.r(e);var i=a("f69f"),s=a("afed");for(var o in s)"default"!==o&&function(t){a.d(e,t,function(){return s[t]})}(o);a("4e3a");var n=a("2877"),d=Object(n["a"])(s["default"],i["a"],i["b"],!1,null,null,null);e["default"]=d.exports},"842c":function(t,e,a){"use strict";a("2346");var i=o(a("b0ce")),s=o(a("71af"));function o(t){return t&&t.__esModule?t:{default:t}}Page((0,i.default)(s.default))},afed:function(t,e,a){"use strict";a.r(e);var i=a("38bd"),s=a.n(i);for(var o in i)"default"!==o&&function(t){a.d(e,t,function(){return i[t]})}(o);e["default"]=s.a},d36a:function(t,e,a){},f69f:function(t,e,a){"use strict";var i=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("view",{staticClass:"goods-detail-box"},[t.detail?a("view",[a("tab-view",{attrs:{type:2,tabBars:t.tabBars,eventid:"08e67eaf-0",mpcomid:"08e67eaf-0"},on:{tapTab:t.tapTab}}),0==t.index?a("block",[a("view",{staticClass:"goods-video-box"},[t._e(),a("swiper",{staticStyle:{height:"100%"},attrs:{circular:"true",interval:"3000",duration:"500",autoplay:"true",eventid:"08e67eaf-1"},on:{change:t.bannerChangeListener}},t._l(t.detail.photos,function(t,e){return a("swiper-item",{key:e,attrs:{mpcomid:"08e67eaf-2-"+e}},[a("image",{staticStyle:{width:"100%",height:"100%"},attrs:{src:t}})])})),a("view",{staticClass:"share-box"},[a("button",{staticClass:"btn-share",attrs:{"open-type":"share"}}),a("text",{staticClass:"iconfont icon-btn_share",staticStyle:{color:"#fff"}})],1),t.detail&&t.detail.photos&&t.detail.photos.length>0?a("view",{staticClass:"dot-bg"},[t._v(t._s(t.currIndex)+"/"+t._s(t.detail.photos?t.detail.photos.length:0))]):t._e()],1),a("view",{staticClass:"bargain-info"},[a("view",{staticClass:"lt-barInfo"},[a("view",{staticClass:"price"},[a("text",[t._v("¥")]),a("text",{staticStyle:{"font-size":"32px","margin-left":"4px"}},[t._v(t._s(t.detail.kj_bargain_price))])]),a("view",{staticClass:"cost-price"},[a("view",{staticClass:"cp-top"},[a("text",[t._v("原价：")]),a("text",{staticStyle:{"text-decoration":"line-through"}},[t._v("¥"+t._s(t.detail.kj_init_price))])]),a("view",{staticClass:"cp-bottom"},[t._v("限时砍价")])]),a("image",{staticClass:"arrow-img",attrs:{src:t.imgBaseUrl+"/box_m@2x.png"}})]),a("view",{staticClass:"rt-barInfo"},[0==t.detail.is_kan?a("view",{staticClass:"rt-top"},[a("text",{staticClass:"iconfont icon-icon_pintuan",staticStyle:{"font-size":"22px"}}),a("text",{staticStyle:{"margin-left":"6px"}},[t._v(t._s(t.detail.kj_sold_num)+"人")])]):t._e(),0==t.detail.is_kan?a("view",{staticClass:"rt-bottom"},[t._v("已"+t._s(t.detail.kj_bargain_price)+"元拿到手")]):t._e(),1==t.detail.is_kan?a("view",{staticClass:"rt-top",staticStyle:{"font-size":"14px"}},[t._v("距离结束还剩")]):t._e(),1==t.detail.is_kan?a("view",{staticClass:"rt-bottom"},[a("uni-countdown",{attrs:{color:"#ffffff",splitorColor:"#ED3005","background-color":"#ED3005","border-color":"rgba(0,0,0,0)",hour:t.hour,minute:t.minute,second:t.second,"show-day":!1,mpcomid:"08e67eaf-3"}})],1):t._e()])]),a("view",{staticClass:"goods-info"},[a("view",{staticClass:"goods-name"},[t._v(t._s(t.detail.goods_name))]),a("view",{staticClass:"goods-price"},[a("text",{staticStyle:{color:"#ED3005","font-size":"16px"}},[t._v("¥")]),a("text",{staticStyle:{color:"#ED3005","font-size":"32px"}},[t._v(t._s(t.detail.shop_price))]),a("text",{staticStyle:{color:"#999999","font-size":"14px","margin-left":"8px"}},[t._v("门市价")]),a("text",{staticStyle:{color:"#999999","font-size":"14px","margin-left":"4px","text-decoration":"line-through"}},[t._v(t._s(t.detail.market_price))])]),a("view",{staticClass:"goods-desc"},[a("view",{staticClass:"item-desc"},[a("text",{staticStyle:{color:"#666666"}},[t._v("快递：")]),a("text",[t._v(t._s(t.detail&&0==t.detail.is_free_shipping?t.detail.shipping_price+"元":"免费"))])]),a("view",{staticClass:"item-desc"},[a("text",{staticStyle:{color:"#666666"}},[t._v("还剩：")]),a("text",[t._v(t._s(t.detail&&t.detail.goods_num?t.detail.goods_num:"0"))])]),a("view",{staticClass:"item-desc"},[a("text",{staticStyle:{color:"#666666"}},[t._v("已购买：")]),a("text",[t._v(t._s(t.detail&&t.detail.kj_sold_num?t.detail.kj_sold_num:"0"))])])])]),a("view",{staticStyle:{width:"100%",height:"12px",background:"#f8f8f8"}}),a("view",{staticClass:"goods-server-info"},[a("view",{staticClass:"item-server"},[a("text",{staticStyle:{width:"50px"}},[t._v("积分")]),a("text",[t._v("购买最高得20积分")])]),a("view",{staticClass:"item-server"},[a("text",{staticStyle:{width:"50px"}},[t._v("配送")]),a("text",[t._v("快递")])]),t._e()]),t.detail.goods_attr?a("goodsDescribe",{attrs:{attr:t.detail.goods_attr,content:t.detail.goods_content,mpcomid:"08e67eaf-4"}}):t._e(),a("view",{staticStyle:{width:"100%",height:"60px"}}),a("view",{staticClass:"bottom-info"},[a("view",{staticClass:"item-bottom-menu",staticStyle:{display:"flex","align-items":"center"}},[a("view",{staticClass:"ib-menu",attrs:{eventid:"08e67eaf-2"},on:{click:t.toHomeListener}},[a("text",{staticClass:"iconfont icon-tabbar",staticStyle:{"font-size":"22px"}}),a("view",{staticStyle:{"font-size":"12px","margin-top":"5px"}},[t._v("首页")])]),a("view",{staticClass:"ib-menu",attrs:{eventid:"08e67eaf-3"},on:{click:t.toCallPhone}},[a("text",{staticClass:"iconfont icon-btn_call",staticStyle:{"font-size":"22px"}}),a("view",{staticStyle:{"font-size":"12px","margin-top":"5px"}},[t._v("客服")])])]),a("view",{staticClass:"item-bottom-menu",staticStyle:{color:"#fff","font-size":"18px",background:"#FFAE19"},attrs:{eventid:"08e67eaf-4"},on:{click:t.buyGoodsListener}},[a("view",{staticClass:"ibmenu-num"},[t._v("¥"+t._s(t.detail&&t.detail.kj_init_price?t.detail.kj_init_price:"0.00"))]),a("view",{staticClass:"ibmenu-text"},[t._v("直接买")])]),a("view",{staticClass:"item-bottom-menu",staticStyle:{color:"#fff","font-size":"18px",background:"#ED3005"},attrs:{eventid:"08e67eaf-5"},on:{click:t.bargainGoodsListener}},[a("view",{staticClass:"ibmenu-num"},[t._v("¥"+t._s(t.detail&&t.detail.kj_bargain_price?t.detail.kj_bargain_price:"0.00"))]),a("view",{staticClass:"ibmenu-text"},[t._v(t._s(1==t.detail.is_kan?"继续砍":"砍价拿"))])])])],1):t._e(),1==t.index?a("block",[a("view",{staticClass:"common-info"},[t._e(),a("view",{staticClass:"comm-type"},[a("view",{staticClass:"item-type",class:1==t.comment_type?"active":"",attrs:{"data-type":"1",eventid:"08e67eaf-6"},on:{click:t.commentTypeListener}},[t._v("全部")]),a("view",{staticClass:"item-type",class:2==t.comment_type?"active":"",attrs:{"data-type":"2",eventid:"08e67eaf-7"},on:{click:t.commentTypeListener}},[t._v("好评")]),a("view",{staticClass:"item-type",class:3==t.comment_type?"active":"",attrs:{"data-type":"3",eventid:"08e67eaf-8"},on:{click:t.commentTypeListener}},[t._v("中评")]),a("view",{staticClass:"item-type",class:4==t.comment_type?"active":"",attrs:{"data-type":"4",eventid:"08e67eaf-9"},on:{click:t.commentTypeListener}},[t._v("差评")])])]),t.comment.length>0?a("view",{staticClass:"common-list"},t._l(t.comment,function(e,i){return a("view",{key:i,staticClass:"item-common"},[a("view",{staticClass:"icom-lt"},[a("image",{staticClass:"user-face",attrs:{src:e.face?e.face:t.imgBaseUrl+"/mine/img_my_head@3x.png"}})]),a("view",{staticClass:"icom-rt"},[a("view",{staticClass:"user-info"},[a("view",{staticClass:"uinfo-lt"},[a("view",{staticClass:"u-name"},[t._v(t._s(e.username))]),a("view",{staticClass:"u-date"},[t._v(t._s(e.add_time))])]),a("view",{staticClass:"uinfo-rt"},[t._l(e.goods_rank,function(t,e){return a("block",{key:t},[a("text",{staticClass:"iconfont icon-Star_c xingxing",staticStyle:{color:"#FFAE19"}})])}),5-e.goods_rank>0?a("block",t._l(5-e.goods_rank,function(t,e){return a("text",{key:t,staticClass:"iconfont icon-Star_c xingxing",staticStyle:{color:"#DFE6EB"}})})):t._e()],2)]),a("view",{staticClass:"common-cont"},[t._v(t._s(e.content))]),a("view",{staticClass:"common-img"},t._l(e.img,function(t,e){return a("image",{key:e,staticClass:"c-img",attrs:{src:t}})}))])])})):t._e(),t.more?a("view",{staticClass:"more",attrs:{bindtap:"getBargainDetail"}},[t._v("点击查看更多")]):t._e(),t.more?t._e():a("view",{staticClass:"nodata"},[t._v("已经全部为你呈现了")])]):t._e(),2==t.index?a("view",{staticClass:"rcm-list"},t._l(t.likes,function(e,i){return a("navigator",{key:i,attrs:{url:"/pages/index/goods/detail?goods_id="+e.goods_id,"open-type":"redirect"}},[a("view",{staticClass:"rcm-goods"},[a("image",{staticClass:"g-img",attrs:{src:e.photosales_sum}}),a("view",{staticClass:"g-info"},[a("view",{staticClass:"ellipsis-02 gname"},[t._v(t._s(e.goods_name))]),a("view",{staticClass:"g-desc"},[a("view",{staticClass:"price-num"},[a("text",[t._v("¥")]),a("text",{staticStyle:{"font-size":"18px"}},[t._v(t._s(e.shop_price))])]),a("view",{staticClass:"sell-num"},[a("text",[t._v(t._s(e.sales_sum))]),a("text",{staticStyle:{color:"#666666"}},[t._v("人已买")])])])])])])})):t._e(),t.likeMore&&2==t.index?a("view",{staticClass:"more",attrs:{eventid:"08e67eaf-10"},on:{click:t.getLikeGoodsList}},[t._v("点击查看更多")]):t._e(),t.likeMore||2!=t.index?t._e():a("view",{staticClass:"nodata"},[t._v("已经全部为你呈现了")])],1):t._e(),a("LoadingView",{attrs:{img:t.imgBaseUrl+"/loading.gif",mpcomid:"08e67eaf-5"}}),a("ToastView",{attrs:{mpcomid:"08e67eaf-6"}}),t.skuFlag?a("skuDialog",{attrs:{specs:t.specs,detail:t.detail,showNum:0==t.buyType?0:1,eventid:"08e67eaf-11",mpcomid:"08e67eaf-7"},on:{addEvent:t.sureSelectGoodsListener,closeEvent:t.hideSkuDialogListener}}):t._e(),t.addressFlag?a("view",{staticClass:"mask"},[a("view",{staticClass:"dialog-address"},[a("view",{staticClass:"d-header"},[a("text",{staticStyle:{flex:"1"}},[t._v("选择收货地址")]),a("text",{staticClass:"iconfont icon-btn_close_black",staticStyle:{"padding-left":"15px"},attrs:{eventid:"08e67eaf-12"},on:{click:t.hideAddressDialogListener}})]),a("addressView",{attrs:{list:t.list,eventid:"08e67eaf-13",mpcomid:"08e67eaf-8"},on:{selectEvent:t.selectAddrListener}})],1)]):t._e()],1)},s=[];a.d(e,"a",function(){return i}),a.d(e,"b",function(){return s})}},[["842c","common/runtime","common/vendor"]]]);