(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/cart/index"],{"02b3":function(t,e,s){},"0881":function(t,e,s){"use strict";var a=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("view",{staticClass:"main"},[t.goods.length>0?s("scroll-view",{attrs:{"scroll-y":""}},[t.list&&t.page>1?s("block",{staticStyle:{height:"100%",background:"#f8f8f8"}},[s("view",{staticClass:"cart-list"},[t.list?s("view",{staticClass:"list-box"},t._l(t.list,function(e,a){return s("view",{key:a,staticClass:"item-ware",class:e.isTouchMove?"ware-move-active":"",attrs:{"data-index":a,eventid:"451031f2-4-"+a},on:{touchstart:t.touchstart,touchmove:t.touchmove}},[s("view",{staticClass:"ware-cont"},[s("view",{staticClass:"w-sel",attrs:{"data-index":a,eventid:"451031f2-0-"+a},on:{click:t.onSelectGoodsListener}},[s("text",{staticClass:"iconfont",class:1==e.selected?"icon-selector_enable":"icon-selector_disable",style:"font-size:20px; color:"+(1==e.selected?"#ED3005":"#888888")})]),s("image",{staticClass:"w-img",attrs:{src:e.photo}}),s("view",{staticClass:"w-cont"},[s("view",{staticClass:"g-name ellipsis-02"},[t._v(t._s(e.goods_name))]),s("view",{staticClass:"g-sku"},[t._v(t._s(e.spec_key_name))]),s("view",{staticClass:"g-desc"},[s("view",{staticClass:"d-price"},[s("text",[t._v("¥")]),s("text",{staticStyle:{"font-size":"22px","margin-right":"2px"}},[t._v(t._s(e.price))])]),s("view",{staticClass:"d-num"},[s("text",{staticClass:"iconfont icon-btn_minus_enabel",attrs:{"data-num":e.goods_num,"data-id":e.cart_id,eventid:"451031f2-1-"+a},on:{click:t.minusGoodsNumListener}}),s("text",{staticClass:"num"},[t._v(t._s(e.goods_num))]),s("text",{staticClass:"iconfont icon-btn_add",attrs:{"data-num":e.goods_num,"data-id":e.cart_id,eventid:"451031f2-2-"+a},on:{click:t.addGoodsNumListener}})])])])]),s("view",{staticClass:"btn-delete",attrs:{"data-id":e.cart_id,eventid:"451031f2-3-"+a},on:{click:t.deleteGoodsListener}},[t._v("删除")])])})):t._e(),0==t.list.length?s("view",{staticClass:"empty-cart"},[s("image",{staticClass:"icon-empty",attrs:{src:t.imgBaseUrl+"/error/icon_none_shoppingcart@2x.png"}}),s("view",{staticClass:"empty-tit-01"},[t._v("购物车空空如也")]),s("view",{staticClass:"empty-tit-02"},[t._v("去添加点什么吧～")])]):t._e()]),s("view",{staticClass:"like-header"},[s("text",{staticClass:"iconfont icon-icon_label_love",staticStyle:{"margin-top":"2px",color:"#f00"}}),s("text",[t._v("猜你喜欢")])]),t.goods.length?s("view",{staticClass:"goods-list"},t._l(t.goods,function(e,a){return s("view",{key:a,staticClass:"item-goods",style:"padding-right:"+(a%2==1?0:2)+"px;padding-left:"+(a%2==0?0:2)+"px;"},[s("navigator",{attrs:{url:"../index/goods/detail?goods_id="+e.goods_id}},[s("view",{staticClass:"img-box"},[s("image",{staticClass:"goods-img",attrs:{src:e.photo}})]),s("view",{staticClass:"goods-name"},[s("text",{staticClass:"ellipsis-02"},[t._v(t._s(e.goods_name))])]),s("view",{staticClass:"goods-desc"},[s("view",{staticClass:"price"},[s("text",{staticStyle:{"font-size":"14px"}},[t._v("¥")]),s("text",{staticStyle:{"font-size":"18px","margin-left":"3px"}},[t._v(t._s(e.shop_price))])]),s("view",{staticClass:"cost-price"},[s("text",[t._v("原价：")]),s("text",{staticClass:"cost"},[t._v(t._s(e.market_price))])]),s("text",{staticClass:"iconfont icon-btn_cart icon-cart"})])])],1)})):t._e(),t.more?s("view",{staticClass:"more",attrs:{eventid:"451031f2-5"},on:{click:t.loadMore}},[t._v("点击查看更多")]):t._e(),t.more?t._e():s("view",{staticClass:"nodata"},[t._v("已经全部为你呈现了")])]):t._e()],1):t._e(),t.goods.length>0?s("view",{staticClass:"buy-info"},[s("view",{staticClass:"buy-desc"},[s("view",{attrs:{eventid:"451031f2-6"},on:{click:t.selectAllGoodsListener}},[s("text",{staticClass:"iconfont btn-sel",class:1==t.all_select?"icon-selector_enable":"icon-selector_disable",style:"color:"+(1==t.all_select?"#ED3005":"#888888")}),s("text",{staticClass:"sel-all"},[t._v("全选")])]),s("view",{staticStyle:{display:"flex","align-items":"flex-end"}},[s("text",{staticClass:"price",staticStyle:{padding:"0 2px 3px 0"}},[t._v("¥")]),s("text",{staticClass:"price",staticStyle:{"font-size":"24px"}},[t._v(t._s(t.totalPrice))])])]),s("view",{staticClass:"btn-buy",attrs:{eventid:"451031f2-7"},on:{click:t.settlement}},[t._v("结算("+t._s(t.goodsNum)+")")])]):t._e(),t.goods.length>0?s("view",{staticStyle:{width:"100%",height:"110px",background:"#F2F4F5"}}):t._e(),s("LoadingView",{attrs:{img:t.imgBaseUrl+"/loading.gif",mpcomid:"451031f2-0"}}),s("ToastView",{attrs:{mpcomid:"451031f2-1"}}),s("page-footer",{attrs:{footer:t.footers,length:t.footers.length,tabIndex:t.tabIndex,color:t.selectColor,mpcomid:"451031f2-2"}})],1)},i=[];s.d(e,"a",function(){return a}),s.d(e,"b",function(){return i})},1794:function(t,e,s){"use strict";var a=s("02b3"),i=s.n(a);i.a},4755:function(t,e,s){"use strict";s.r(e);var a=s("47d9"),i=s.n(a);for(var o in a)"default"!==o&&function(t){s.d(e,t,function(){return a[t]})}(o);e["default"]=i.a},"47d9":function(t,e,s){"use strict";(function(t){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var s={data:function(){return{userid:0,startX:0,startY:0,tabIndex:2,selectColor:"#ED3005",footers:[],page:1,more:0,list:[],goods:[],goodsNum:0,totalPrice:0,all_select:0,imgBaseUrl:""}},created:function(){this.$data.imgBaseUrl=this.wxb.imgBaseUrl},onLoad:function(e){var s=this,a=t.getStorageSync("user_id");void 0!=a&&""!=a&&(s.$data.userid=a),void 0!=e.pid&&""!=e.pid&&t.setStorageSync("pid",e.pid),s.wxb.addPage(this),s.wxb.Init(e,function(t){console.log(e),s.$data.footers=s.wxb.skin.footer.list,s.$data.tabIndex=s.wxb.getCurrPageIndex("/pages/cart/index",s.$data.footers)-0,s.$data.selectColor=s.wxb.skin.footer.selectColor,console.log("tabIndex=>"+s.$data.tabIndex),void 0!=e.p_cat_id&&void 0!=e.cat_id&&(s.$data.p_cat_id=e.p_cat_id,s.$data.cat_id=e.cat_id),s.getCartList()})},onUnload:function(){this.wxb.removePage()},onShareAppMessage:function(){var t=this;return{title:t.$data.shareTitle?t.$data.shareTitle:"营销电商",path:"/pages/index/index?pid="+t.$data.userid}},methods:{settlement:function(e){this.$data.goodsNum<=0?this.$showToast({show:!0,content:"请勾选购买的产品"}):t.navigateTo({url:"/pages/cart/buy"})},onSelectGoodsListener:function(t){var e=this,s=t.currentTarget.dataset.index;e.wxb.Post("/shop/api.cart/selectCart",{cart_id:e.$data.list[s].cart_id},function(t){e.$data.list[s].selected=1==e.$data.list[s].selected?0:1,e.countGoodsTotalPrice()})},selectAllGoodsListener:function(t){var e=this.$data.all_select,s=this.$data.list;for(var a in this.$data.all_select=1==e?0:1,s)1==this.$data.all_select?s[a].selected=1:s[a].selected=0;this.$data.list=s,this.countGoodsTotalPrice();var i=this;i.wxb.Post("/shop/api.cart/selectCartAll",{is_select:1==e?0:1},function(t){})},countGoodsTotalPrice:function(t){var e=this.$data.list,s=0,a=0,i=1;for(var o in e)1==e[o].selected?(this.wxb.printLog("单价："+e[o].price),this.wxb.printLog("数量："+e[o].goods_num),this.wxb.printLog("计算价格=>"+(e[o].price-0)*(e[o].goods_num-0)),s+=(e[o].price-0)*(e[o].goods_num-0),a+=e[o].goods_num-0):0==e[o].selected&&(i=0);this.$data.all_select=i,this.$data.totalPrice=s,this.$data.goodsNum=a},minusGoodsNumListener:function(t){var e=t.currentTarget.dataset.num,s=t.currentTarget.dataset.id;e<=1?this.$showToast({show:!0,content:"至少购买一件商品"}):(e-=1,this.changeGoodsNumListener(s,e))},addGoodsNumListener:function(t){var e=t.currentTarget.dataset.num,s=t.currentTarget.dataset.id;e=e-0+1,this.changeGoodsNumListener(s,e)},changeGoodsNumListener:function(t,e){var s=this;s.wxb.Post("/shop/api.Cart/editCart",{cart_id:t,num:e},function(t){s.$data.page=1,s.getCartList()})},deleteGoodsListener:function(t){var e=this,s=t.currentTarget.dataset.id,a=t.currentTarget.dataset.index,i=e.$data.list;e.wxb.Post("/shop/api.Cart/delCart",{cart_id:s},function(t){i.splice(a,1),e.$showToast({show:!0,content:"该商品已成功删除"})}),e.$data.list=i},touchstart:function(t){console.log(t),console.log("我要开始划动拉"),console.log(this.wxb.device);var e=this.$data.list;for(var s in e)e[s].isTouchMove&&(e[s].isTouchMove=!1);"h5"==this.wxb.device?(this.$data.startX=t.changedTouches[0].clientX,this.$data.startY=t.changedTouches[0].clientY):(this.$data.startX=t.cclientX,this.$data.startY=t.clientY),this.$data.list=e},touchmove:function(t){var e=this,s=t.currentTarget.dataset.index,a=e.$data.startX,i=e.$data.startY;if("h5"==this.wxb.device)var o=t.changedTouches[0].clientX,n=t.changedTouches[0].clientY;else o=t.cclientX,n=t.clientY;var c=e.$data.list,r=e.angle({X:a,Y:i},{X:o,Y:n});for(var l in c){if(c[l].isTouchMove=!1,Math.abs(r)>30)return;l==s&&(c[l].isTouchMove=!(o>a))}e.$data.list=c},angle:function(t,e){var s=e.X-t.X,a=e.Y-t.Y;return 360*Math.atan(a/s)/(2*Math.PI)},loadMore:function(t){this.wxb.printLog("分页加载更多"),this.getCartList()},getCartList:function(){var t=this,e=t.$data.page,s=t.$data.goods;1==e&&(s=[]),t.wxb.Post("/shop/api.Cart/index",{page:t.$data.page},function(a){if(1==e){var i=a.list;for(var o in i)i[o].isTouchMove=!1;t.$data.list=i}var n=a.tuijian;for(var o in n)s.push(n[o]),t.countGoodsTotalPrice();t.$data.goods=s,t.$data.more=a.isMore,t.$data.page+=1})}}};e.default=s}).call(this,s("543d")["default"])},d600:function(t,e,s){"use strict";s("2346");var a=o(s("b0ce")),i=o(s("ee5e"));function o(t){return t&&t.__esModule?t:{default:t}}Page((0,a.default)(i.default))},ee5e:function(t,e,s){"use strict";s.r(e);var a=s("0881"),i=s("4755");for(var o in i)"default"!==o&&function(t){s.d(e,t,function(){return i[t]})}(o);s("1794");var n=s("2877"),c=Object(n["a"])(i["default"],a["a"],a["b"],!1,null,null,null);e["default"]=c.exports}},[["d600","common/runtime","common/vendor"]]]);