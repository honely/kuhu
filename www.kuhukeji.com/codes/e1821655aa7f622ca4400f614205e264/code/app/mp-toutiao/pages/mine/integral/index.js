(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/mine/integral/index"],{"3ed8":function(t,e,a){"use strict";(function(t){function a(t,e){return n(t)||s(t,e)||i()}function i(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}function s(t,e){var a=[],i=!0,s=!1,n=void 0;try{for(var r,d=t[Symbol.iterator]();!(i=(r=d.next()).done);i=!0)if(a.push(r.value),e&&a.length===e)break}catch(o){s=!0,n=o}finally{try{i||null==d["return"]||d["return"]()}finally{if(s)throw n}}return a}function n(t){if(Array.isArray(t))return t}Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var r={data:function(){for(var t=new Date,e=[],a=[],i=[],s=2016;s<=t.getFullYear();s++)e.push(s);for(var n=1;n<=12;n++)a.push(n);for(var r=1;r<=31;r++)i.push(r);return{userid:0,years:e,months:a,days:i,integerNum:0,list:[],page:1,more:0,type_means:[],typeId:"",selectMsg:"",startDate:"",endDate:"",screenType:0,screenTypeFlag:!1,msgType:0,dateType:0,dateValue:[9999,t.getMonth(),t.getDate()-2],screenDateFlag:!1,screenFlag:!1,imgBaseUrl:""}},onLoad:function(e){var a=this,i=t.getStorageSync("user_id");void 0!=i&&""!=i&&(a.$data.userid=i),void 0!=e.pid&&""!=e.pid&&t.setStorageSync("pid",e.pid),a.wxb.addPage(this),a.wxb.Init(e,function(t){a.getIntegralInfo()})},created:function(){this.$data.imgBaseUrl=this.wxb.imgBaseUrl},onUnload:function(){this.wxb.removePage()},onShareAppMessage:function(){var t=this;return{title:""==t.$data.companyName?"O2O电商小程序":t.$data.companyName,path:"/pages/index/index?pid="+t.$data.userid}},methods:{sureScreenListener:function(t){this.$data.page=1,this.getIntegralInfo(),this.onHiddenScreenDialog()},onHiddenScreenDialog:function(t){this.$data.screenFlag=!1},onShowScreenDialog:function(t){this.$data.screenFlag=!0},onSureDateListener:function(){console.log("完成日期选择");var t=this.$data.startDate,e=this.$data.endDate;return console.log(new Date(e).getTime()-new Date(t).getTime()),new Date(e)<=new Date(t)?(this.$data.msgType=1,void(this.$data.msg="开始日期必须小于结束日期")):new Date(e).getTime()-new Date(t).getTime()>31536e6?(this.$data.msgType=1,void(this.$data.msg="仅支持查找12个月跨度以内的数据")):(this.$data.selectMsg=t+"至"+e,void this.onHiddenScreenDateDialog())},bindChangeListener:function(t){var e=new Date,i=this.$data.years,s=this.$data.months,n=this.$data.days,r=a(t.detail.value,3),d=r[0],o=r[1],c=r[2],l=i[d],h=s[o];if(e.getFullYear()==l){s=[];for(var _=1;_<=e.getMonth()+1;_++)s.push(_);if(n=[],e.getFullYear()==l&&e.getMonth()+1==h)for(var g=1;g<=e.getDate();g++)n.push(g);else for(var u=new Date(l,h,0).getDate(),v=1;v<=u;v++)n.push(v)}else{s=[];for(var f=1;f<=12;f++)s.push(f);n=[];u=new Date(l,h,0).getDate();for(var p=1;p<=u;p++)n.push(p)}this.$data.years=i,this.$data.months=s,this.$data.days=n,this.$data.msgType=0;var m=this.$data.dateType,y=i[d]+"-"+(s[o]>9?s[o]:"0"+s[o])+"-"+(n[c]>9?n[c]:"0"+n[c]);console.log("选择的日期："+y),0==m?this.$data.startDate=y:1==m&&(this.$data.endDate=y)},onHiddenScreenDateDialog:function(t){this.$data.screenDateFlag=!1},onShowScreenDateDialog:function(t){var e=this;""!=e.$data.startDate&&""!=e.$data.endDate||(e.$data.startDate=e.getDateFormat(-1),e.$data.endDate=e.getDateFormat(0)),e.$data.screenDateFlag=!0},onShowScreenTypeDialog:function(t){this.$data.screenTypeFlag=!0},onHiddenScreenTypeDialog:function(t){this.$data.screenTypeFlag=!1},onDateTypeListener:function(t){var e=this,a=new Date,i=t.currentTarget.dataset.type,s=e.$data.selectMsg,n=e.$data.startDate;4==i?(""!=n&&""!=e.$data.endDate||(e.$data.startDate=e.getDateFormat(-1),e.$data.endDate=e.getDateFormat(0)),console.log(this.$data.startDate),console.log(this.$data.endDate),this.onHiddenScreenTypeDialog(),this.onShowScreenDateDialog()):(1==i?(s="近三月",n=e.timeFormatDate(a.getTime()-7776e6),console.log(n)):2==i?(s="近一月",n=e.timeFormatDate(a.getTime()-2592e6),console.log(n)):3==i&&(s="近一周",n=e.timeFormatDate(a.getTime()-6048e5),console.log(n)),e.$data.selectMsg=s,e.$data.endDate=e.getDateFormat(0),e.$data.startDate=n),e.$data.screenType=i,e.$data.screenTypeFlag=!1},onClickStartListener:function(t){var e=new Date(this.$data.startDate),a=e.getFullYear(),i=e.getMonth()+1,s=e.getDate();this.$data.dateType=0,this.$data.dateValue=this.getDateIndex(a,i,s),console.log("选择开始日期=>"+this.$data.dateValue)},getDateIndex:function(t,e,a){console.log(t),console.log(e),console.log(a);var i=this.$data.years,s=this.$data.months,n=this.$data.days,r=this.$data.dateValue;for(var d in i)if(i[d]==t&&r){this.wxb.printLog("length=>"+r.length),r[0]=d-0;break}for(var d in s)if(s[d]==e&&r){r[1]=d-0;break}for(var d in n)if(n[d]==a&&r){r[2]=d-0;break}return console.log(r),r},onClickEndListener:function(t){console.log(this.$data.endDate);var e=new Date(this.$data.endDate),a=e.getFullYear(),i=e.getMonth()+1,s=e.getDate(),n=this.getDateIndex(a,i,s);this.$data.dateType=1,this.$data.dateValue=n},getDateFormat:function(t){var e=new Date;e.setDate(e.getDate()+t);var a=e.getFullYear(),i=e.getMonth()+1;t=e.getDate();return i>=1&&i<=9&&(i="0"+i),t>=0&&t<=9&&(t="0"+t),a+"-"+i+"-"+t},timeFormatDate:function(t){var e=new Date(t),a=e.getFullYear(),i=e.getMonth()+1,s=e.getDate();return a+"-"+(i>9?i:"0"+i)+"-"+(s>9?s:"0"+s)},selectScreenTypeListener:function(t){var e=t.currentTarget.dataset.id;this.$data.typeId=e},getIntegralInfo:function(t){var e=this,a=e.$data.list;1==e.$data.page&&(a=[]),e.wxb.Post("/shop/api.user/myIntegral",{date_type:e.$data.screenType,date_area_start:e.$data.startDate,date_area_end:e.$data.endDate,type:e.$data.typeId,page:e.$data.page},function(t){if(t){for(var i in t.list)a.push(t.list[i]);e.$data.type_means=t.type_means,e.$data.typeId=t.type_means[0].key,e.$data.integerNum=t.integral,e.$data.list=t.list,e.$data.page=1,e.$data.more=t.more}})}}};e.default=r}).call(this,a("f266")["default"])},"70e9":function(t,e,a){"use strict";var i=a("bd38"),s=a.n(i);s.a},"870e":function(t,e,a){"use strict";a.r(e);var i=a("3ed8"),s=a.n(i);for(var n in i)"default"!==n&&function(t){a.d(e,t,function(){return i[t]})}(n);e["default"]=s.a},a72c:function(t,e,a){"use strict";a.r(e);var i=a("ec67"),s=a("870e");for(var n in s)"default"!==n&&function(t){a.d(e,t,function(){return s[t]})}(n);a("70e9");var r=a("2877"),d=Object(r["a"])(s["default"],i["a"],i["b"],!1,null,null,null);e["default"]=d.exports},bd38:function(t,e,a){},c64e:function(t,e,a){"use strict";a("2346");var i=n(a("a72c")),s=n(a("3a53"));function n(t){return t&&t.__esModule?t:{default:t}}i.default.mpType="page";var r=new s.default(i.default);r.$mount()},ec67:function(t,e,a){"use strict";var i=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("scroll-view",{attrs:{"scroll-y":"true",_hid:0}},[a("view",{staticClass:"integral-box",attrs:{_hid:1}},[a("view",{staticClass:"integral-bg",attrs:{_hid:2}}),a("view",{staticClass:"integral-info",attrs:{_hid:3}},[a("view",{staticClass:"ii-tit",attrs:{_hid:4}},[]),a("view",{staticClass:"ii-num",attrs:{_hid:6}},[t._v(t._s(t.integerNum),7)]),a("view",{staticClass:"ii-button",attrs:{_hid:8}},[a("navigator",{staticClass:"item-button btn-mall",attrs:{url:"../mall/index",_hid:9}},[]),a("navigator",{staticClass:"item-button btn-record",attrs:{url:"../mall/order/index",_hid:11}},[])],1)])]),a("view",{staticClass:"integral-desc",attrs:{_hid:13}},[a("view",{staticClass:"header-integral",attrs:{_hid:14}},[a("view",{staticClass:"hw-lt",attrs:{_hid:15}},[a("text",{staticClass:"iconfont icon-icon_integral",staticStyle:{"margin-right":"8px"},attrs:{_hid:16}}),a("text",{attrs:{_hid:17}},[])]),a("view",{staticClass:"hw-rt",attrs:{_hid:19},on:{click:t.onShowScreenDialog}},[a("text",{staticClass:"iconfont icon-btn_filter",attrs:{_hid:20}}),a("text",{staticStyle:{"margin-left":"7px"},attrs:{_hid:21}},[])])]),a("view",{staticClass:"integral-list",attrs:{_hid:23}},[t._l(t.list,function(e,i,s){var n=void 0!==s?s:i;return a("view",{key:i,staticClass:"item-integral",attrs:{_hid:24,_fid:n,_fk:"index"}},[a("view",{staticClass:"iw-lt",attrs:{_hid:25,_fid:n}},[a("view",{staticClass:"pay-type",attrs:{_hid:26,_fid:n}},[t._v(t._s(e.type_mean),27,n)]),a("view",{staticClass:"pay-date",attrs:{_hid:28,_fid:n}},[t._v(t._s(e.add_time),29,n)])]),a("view",{staticClass:"iw-rt",style:"color:"+("add"==e.mark?"#000":"#f00"),attrs:{_hid:30,_fid:n}},[t._v(t._s("reduce"==e.mark?"-":"+")+t._s(e.num),31,n)])])},24,t._self),t._ri(!!t.more,32)?a("view",{staticClass:"more",attrs:{bindtap:"loadMore",_hid:32}},[]):t._e(),t._ri(!t.more,34)?a("view",{staticClass:"nodata",attrs:{_hid:34}},[]):t._e()],1)]),a("LoadingView",{attrs:{img:t.imgBaseUrl+"/loading.gif",_hid:36,_batrs:"img",_cid:0}}),a("ToastView",{attrs:{_hid:1038,_cid:1}}),t._ri(!!t.screenFlag,2040)?a("view",{staticClass:"mask",staticStyle:{"z-index":"0",top:"44px"},attrs:{_hid:2040}},[a("view",{staticClass:"dialog-content",attrs:{_hid:2041}},[a("view",{staticClass:"apply-header",attrs:{_hid:2042}},[a("view",{staticClass:"apply-tit",attrs:{_hid:2043}},[]),a("view",{staticClass:"apply-close",attrs:{_hid:2045},on:{click:t.onHiddenScreenDialog}},[a("text",{staticClass:"iconfont icon-btn_close_black",attrs:{_hid:2046}})])]),a("view",{staticClass:"apply-cont",attrs:{_hid:2047}},[a("view",{staticClass:"screen-cont",attrs:{_hid:2048}},[a("view",{staticClass:"s-title",attrs:{_hid:2049}},[]),a("view",{staticClass:"s-listBox",attrs:{_hid:2051}},t._l(t.type_means,function(e,i,s){var n=void 0!==s?s:i;return a("view",{key:i,staticClass:"item-screen",attrs:{"data-id":e.key,_hid:2052,_fid:n,_batrs:"data-id",_fk:"index"},on:{click:t.selectScreenTypeListener}},[a("view",{class:t.typeId==e.key?"screen-sel":"screen-nor",attrs:{_hid:2053,_fid:n}},[t._v(t._s(e.val),2054,n)])])},2052,t._self))]),a("view",{staticClass:"screen-type",attrs:{_hid:2055}},[a("view",{staticClass:"screen-lt",attrs:{_hid:2056},on:{click:t.onShowScreenDateDialog}},[]),a("view",{staticClass:"screen-rt",attrs:{_hid:2058},on:{click:t.onShowScreenTypeDialog}},[a("text",{attrs:{_hid:2059}},[t._v(t._s(""==t.selectMsg?"请选择":t.selectMsg),2060)]),a("text",{staticClass:"iconfont icon-btn_arrowr",attrs:{_hid:2061}})])]),a("view",{staticClass:"btn-save",attrs:{_hid:2062},on:{click:t.sureScreenListener}},[])])])]):t._e(),t._ri(!!t.screenTypeFlag,2064)?a("view",{staticClass:"mask",attrs:{_hid:2064}},[a("view",{staticClass:"time-listBox",attrs:{_hid:2065}},[a("view",{staticClass:"item-time",attrs:{"data-type":"1",_hid:2066},on:{click:t.onDateTypeListener}},[a("text",{staticClass:"name",attrs:{_hid:2067}},[]),t._ri(!(1!=t.screenType),2069)?a("text",{staticClass:"arrow iconfont icon-icon_radio",staticStyle:{color:"#f00"},attrs:{_hid:2069}}):t._e()]),a("view",{staticClass:"item-time",attrs:{"data-type":"2",_hid:2070},on:{click:t.onDateTypeListener}},[a("text",{staticClass:"name",attrs:{_hid:2071}},[]),t._ri(!(2!=t.screenType),2073)?a("text",{staticClass:"arrow iconfont icon-icon_radio",staticStyle:{color:"#f00"},attrs:{_hid:2073}}):t._e()]),a("view",{staticClass:"item-time",attrs:{"data-type":"3",_hid:2074},on:{click:t.onDateTypeListener}},[a("text",{staticClass:"name",attrs:{_hid:2075}},[]),t._ri(!(3!=t.screenType),2077)?a("text",{staticClass:"arrow iconfont icon-icon_radio",staticStyle:{color:"#f00"},attrs:{_hid:2077}}):t._e()]),a("view",{staticClass:"item-time",attrs:{"data-type":"4",_hid:2078},on:{click:t.onDateTypeListener}},[a("text",{staticClass:"name",attrs:{_hid:2079}},[]),t._ri(!(4!=t.screenType),2081)?a("text",{staticClass:"arrow iconfont icon-icon_radio",staticStyle:{color:"#f00"},attrs:{_hid:2081}}):t._e()])])]):t._e(),t._ri(!!t.screenDateFlag,2082)?a("view",{staticClass:"mask",attrs:{_hid:2082}},[a("view",{staticClass:"time-listBox",attrs:{_hid:2083}},[a("view",{staticClass:"item-time",attrs:{_hid:2084}},[a("view",{staticClass:"date-cancel",attrs:{_hid:2085},on:{click:t.onHiddenScreenDateDialog}},[]),a("view",{staticClass:"date-title",style:"color:"+(0==t.msgType?"#2D3133":"#FF3200"),attrs:{_hid:2087}},[t._v(t._s(0==t.msgType?"选择起始日期":t.msg),2088)]),a("view",{staticClass:"date-sure",attrs:{_hid:2089},on:{click:t.onSureDateListener}},[])]),a("view",{staticClass:"date-cont",attrs:{_hid:2091}},[a("view",{staticClass:"item",attrs:{_hid:2092},on:{click:t.onClickStartListener}},[a("text",{class:0==t.dateType?"blue":"gray",attrs:{_hid:2093}},[t._v(t._s(t.startDate),2094)])]),a("view",{staticClass:"item",attrs:{_hid:2095}},[]),a("view",{staticClass:"item",attrs:{_hid:2097},on:{click:t.onClickEndListener}},[a("text",{class:1==t.dateType?"blue":"gray",attrs:{_hid:2098}},[t._v(t._s(t.endDate),2099)])])]),a("picker-view",{staticStyle:{width:"100%",height:"150px"},attrs:{"indicator-style":"height: 50px;",value:t.dateValue,_hid:2100,_batrs:"value"},on:{change:t.bindChangeListener}},[a("picker-view-column",{attrs:{_hid:2101,_cid:2}},t._l(t.years,function(e,i,s){var n=void 0!==s?s:i;return a("view",{key:i,staticClass:"picker-date",attrs:{_hid:3103,_fid:n,_fk:"index"}},[t._v(t._s(e)+"年",3104,n)])},3103,t._self)),a("picker-view-column",{attrs:{_hid:3105,_cid:3}},t._l(t.months,function(e,i,s){var n=void 0!==s?s:i;return a("view",{key:i,staticClass:"picker-date",attrs:{_hid:4107,_fid:n,_fk:"index"}},[t._v(t._s(e)+"月",4108,n)])},4107,t._self)),a("picker-view-column",{attrs:{_hid:4109,_cid:4}},t._l(t.days,function(e,i,s){var n=void 0!==s?s:i;return a("view",{key:i,staticClass:"picker-date",attrs:{_hid:5111,_fid:n,_fk:"index"}},[t._v(t._s(e)+"日",5112,n)])},5111,t._self))],1)],1)]):t._e()],1)},s=[];a.d(e,"a",function(){return i}),a.d(e,"b",function(){return s})}},[["c64e","common/runtime","common/vendor"]]]);