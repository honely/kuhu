<!DOCTYPE html>
<html>
    <head>
        <title>我要有小程序制作系统安装执行脚本,www.woyaou.com</title>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">

        <script src="/install/statics/jquery.min.js"></script>
        <script src="https://cdn.jsdelivr.net/npm/vue"></script>
        <link rel="stylesheet" href="https://unpkg.com/element-ui/lib/theme-chalk/index.css">
        <script src="https://unpkg.com/element-ui/lib/index.js"></script>

        <link type="text/css" rel="stylesheet" href="/install/statics/css/common.css"/>
        <link type="text/css" rel="stylesheet" href="/install/statics/css/css.css"/>

    </head>
    <body>
        <div id="app">
            <el-container>
                <el-header class="header">
                    <div class="header-nav">
                        <div class="logo">
                            <a href="/install"><img src="/install/statics/images/logo.png" /></a>
                        </div>
                        <div class="togw"><a target="_blank" href="https://www.woyaou.com">访问官网</a></div>

                    </div>
                </el-header>
                <el-main>
                    <div class="main-box">
                        <el-steps :active="pageIndex" simple>
                            <el-step title="1、同意协议"></el-step>
                            <el-step title="2、安装检查"></el-step>
                            <el-step title="3、安装软件"></el-step>
                            <el-step title="4、安装完成"></el-step>
                        </el-steps>

                        <el-card v-if="pageIndex == 0" class="install-main">
                            <h2>请认真阅读软件安装协议</h2>

                            <div class="license-box">
                                <p>&nbsp;&nbsp;&nbsp;&nbsp;感谢您选择我要有多合一小程序制作系统（以下简称我要有），我要有将为打造精品小程序应用平台而不懈努力！</p>
                                <p style="margin-bottom:10px;">&nbsp;&nbsp;&nbsp;&nbsp;本《我要有多合一小程序制作系统最终用户授权许可协议》（以下简称“协议”）是您（自然人、法人或其他组织）
                                    与合肥微小宝网络科技有限公司之间（以下简称“合肥微小宝”）有关复制、下载、安装、使用我要有的法律协议，同时本协议亦适用于任何有关我要有的后期更新和升级。一旦复制、下载、安装或以其他方式使用我要有，即表明您同意接受本协议各项条款的约束。<br/><span style="color:#f00;">&nbsp;&nbsp;&nbsp;&nbsp;如果您不同意本协议中的条款，请勿复制、下载、安装或以其他方式使用我要有。</span>
                                </p>

                                <p><STRONG style="font-size:16px;">许可您的权利：</STRONG></p>
                                <p>您可以在完全遵守本最终用户授权协议的基础上，将我要有应用于非商业用途或个人网站，而不必支付软件版权授权费用。</p>
                                <p>您可以在协议规定的约束和限制范围内根据需要对我要有进行必要的修改和美化，以适应您的网站要求。</p>
                                <p>您拥有使用我要有构建的网站中的全部内容的所有权，并独立承担与内容相关的法律义务。</p> <p>获得商业授权之后，您可以将我要有应用于商业用途，同时依据所购买的授权类型中确定的技术支持服务等级、期限、服务方式和服务内容，自购买时刻起，在技术支持服务期限内拥有通过指定的方式获得指定范围内的技术支持服务。</p> 

                                <p><STRONG style="font-size:16px;">约束和限制：</STRONG></p>
                                <p><font style="color:#f00;">未获商业授权之前，不得将我要有用于商业用途（包括但不限于企业网站、政府、金融、教育机构、学校、社会团体及其他经营性网站、以营利为目或实现盈利的网站，个人网站永久免费且不限制用途）。</font> </p>
                                <p>未经官方许可，不得对我要有或与之关联的商业授权进行出租、出售、抵押或发放子许可证。</p> 
                                <p><font  style=" color:#f00;">无论如何，即无论用途如何、是否经过修改或美化、修改程度如何，只要使用我要有的整体或任何部分，未经书面授权许可，软件页面页脚处的版权标识（我要有）和官方网址（http://www.woyaou.com）的链接都必须保留，而不能清除或修改。</font></p>
                                <p>禁止在我要有的整体或任何部分基础上以发展任何派生版本、修改版本或第三方版本用于重新分发。</p> 
                                <p>如果您未能遵守本协议的条款，您的授权将被终止，所被许可的权利将被收回，并承担相应法律责任。</p> 

                                <p><STRONG style="font-size:16px;">有限担保和免责声明：</STRONG></p>

                                <p>我要有及所附带的文件是作为不提供任何明确的或隐含的赔偿或担保的形式提供的。</p>
                                <p>用户出于自愿而使用我要有，<span style="color:#f00;">您必须了解使用我要有的风险，在尚未购买产品技术服务之前，我们不承诺提供任何形式的技术支持、使用担保，也不承担任何因使用我要有而产生问题的相关责任。</span></p>
                                <p>合肥微小宝不对使用我要有构建的网站的任何信息内容以及导致的任何版权纠纷和法律争议及后果承担责任。</p>
                                <p>电子文本形式的授权协议如同双方书面签署的协议一样，具有完全的和等同的法律效力。您一旦开始确认本协议并安装我要有，即被视为完全理解并接受本协议的各项条款，在享有上述条款授予的权力的同时，受到相关的约束和限制。协议许可范围以外的行为，将直接违反本授权协议并构成侵权，我们有权随时终止授权，责令停止损害，并保留追究相关责任的权力。
                                </p>

                            </div>
                            <div class="action-list">    
                                <el-button @click="nextCheck()" style="width: 300px;">同意并进入下一步</el-button>
                            </div>
                        </el-card>
                        <el-card v-if="pageIndex == 1" v-loading="checkLoading" class="install-main">
                               
                               <div class="checkItem">
                                   <p style="font-size:16px;">目录权限检测:</p>
                                   
                                   <ul>
                                       <li :style="{color:item.type==0 ? 'red' : '#333333'}" v-for="(item,index) in dir">
                                           {{item.msg}} <i style="color:green;" v-if="item.type==1" class="el-icon-circle-check"></i><i  v-if="item.type==0"  style="color:red;" class="el-icon-remove"></i>
                                       </li>
                                   </ul>
                               </div>
                               
                               <div class="checkItem">
                                   <p style="font-size:16px;">函授检查：</p>
                                    <ul>
                                       <li  :style="{color:item.type==0 ? 'red' : '#333333'}" v-for="(item,index) in func">
                                           {{item.msg}} <i style="color:green;" v-if="item.type==1" class="el-icon-circle-check"></i><i  v-if="item.type==0"  style="color:red;" class="el-icon-remove"></i>
                                       </li>
                                   </ul>
                               </div>
                               
                               <div class="action-list">    
                                <el-button v-if="isYes" @click="pageIndex=2" style="width: 200px;">下一步</el-button>
                                 <el-button @click="goback()" type="text">返回</el-button>
                              </div>
                        </el-card>
                        <el-card v-if="pageIndex == 2" v-loading="installLoading"  class="install-main">
                            <el-form :model="formdata" :rules="rules" ref="ruleForm" size="small" label-width="100px" >
                            <p style="font-size:16px;margin-bottom: 20px;">我要有官方信息填写:<span style="font-size: 13px;">(去我要有官网注册获取域名填写您当前安装域名,<a style="color:blue;" target="_blank" href="http://www.woyaou.com">点击这里</a>)</span></p>
                            <el-form-item label="APPID" prop="appId">
                                <el-input style="width:300px;" v-model="formdata.appId"></el-input>
                            </el-form-item>
                            <el-form-item label="APPTOKEN" prop="appToken">
                                <el-input style="width:300px;"  v-model="formdata.appToken"></el-input>
                            </el-form-item>
                            
                            <p style="font-size:16px;margin-bottom: 20px;">数据库信息：</p>
                            <el-form-item label="数据库地址" prop="dbhost">
                                <el-input style="width:300px;" v-model="formdata.dbhost"></el-input>
                            </el-form-item>
                            <el-form-item label="数据库端口" prop="dbport">
                                <el-input style="width:300px;"  v-model="formdata.dbport"></el-input>
                            </el-form-item>
                            <el-form-item label="数据库账号" prop="dbuser">
                                <el-input style="width:300px;"  v-model="formdata.dbuser"></el-input>
                            </el-form-item>
                            <el-form-item label="数据库密码" prop="dbpwd">
                                <el-input style="width:300px;"  v-model="formdata.dbpwd"></el-input>
                            </el-form-item>
                            <el-form-item label="数据库名称" prop="dbname">
                                <el-input style="width:300px;"  v-model="formdata.dbname"></el-input>
                            </el-form-item>
                            <p style="font-size:16px;margin-bottom: 20px;">后台账号和密码：</p>
                             <el-form-item label="后台账号" prop="admin">
                                <el-input style="width:300px;"  v-model="formdata.admin"></el-input>
                            </el-form-item>
                            <el-form-item label="后台密码" prop="password">
                                <el-input style="width:300px;"  v-model="formdata.password"></el-input>
                            </el-form-item>
                             <el-form-item>
                                <el-button type="primary" @click="submitForm('ruleForm')">立刻安装</el-button>
                              </el-form-item>
                            </el-form> 
                        </el-card>
                        
                        <el-card v-if="pageIndex == 3"  class="install-main">
                            
                            <div class="install-gx">恭喜您，安装程序成功！</div>
                            <div class="install-yes">
                                <a href="/">前往网站首页</a>
                                <a href="/admin">进入管理后台</a>
                            </div>
                        </el-card>
                    </div>
                </el-main>
                <el-footer>
                    <div class="footer">技术支持 : www.woyaou.com</div>
                </el-footer>
            </el-container>


        </div>

        <script>
            $.ajaxSetup({cache:false});
            var vm = new Vue({
                el: '#app',
                data: {
                    pageIndex:0,
                    checkLoading : false,
                    installLoading:false,
                    isYes:0,
                    dir:[],
                    func:[],
                    formdata:{
                        appId:'',
                        appToken:'',
                        dbhost:'localhost',
                        dbport:'3306',
                        dbuser:'',
                        dbpwd:'',
                        dbname:'',
                        admin:'woyaou',
                        password:'',
                    },
                    rules: {
                        appId: [
                          { required: true, message: 'APPID不能为空', trigger: 'blur' },
                        ],
                        appToken: [
                          { required: true, message: 'APPToken不能为空', trigger: 'blur' },
                        ],
                        dbhost: [
                          { required: true, message: '数据库主机不能为空', trigger: 'blur' },
                        ],
                        dbport: [
                          { required: true, message: '数据库端口不能为空', trigger: 'blur' },
                        ],
                        dbuser: [
                          { required: true, message: '数据库用户不能为空', trigger: 'blur' },
                        ],
                        dbpwd: [
                          { required: true, message: '数据库密码不能为空', trigger: 'blur' },
                        ],
                        dbname: [
                          { required: true, message: '数据库名称不能为空', trigger: 'blur' },
                        ],
                        admin: [
                          { required: true, message: '管理员账号不能为空', trigger: 'blur' },
                        ],
                        password: [
                          { required: true, message: '管理员密码不能为空', trigger: 'blur' },
                        ],
                        
                    }
                },
                methods: {
                    goback(){
                        this.pageIndex = 0;
                    },
                    submitForm(formName){
                        var that = this;
                        this.$refs[formName].validate((valid) => {
                            if (valid) {
                                that.installLoading = true;
                                $.post('/install/index.php?action=install',that.formdata,function(data){
                                    if(data == 1){
                                        that.pageIndex = 3;
                                    }else{
                                        that.$message.error('安装出错了');
                                    }
                                    that.installLoading = false;
                                },'html')
                            } else {
                              return false;
                            }
                        });
                    },
                    nextCheck(){
                            this.pageIndex = 1;
                            if(this.checkLoading == false){
                                this.checkLoading = true;
                                var that = this;
                                $.get('/install/index.php?action=check',function(data){
                                        that.isYes = data.isYes;
                                        that.func = data.func;
                                        that.dir = data.dir;
                                        that.checkLoading = false;
                                },'json');
                            }
                        },
                    }
            });

        </script>

    </body>
</html>