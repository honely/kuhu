(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-0456df56"],{2376:function(t,e,a){"use strict";a.r(e);var i=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("top-nav",{attrs:{title:t.datas.appTypeInfo?t.datas.appTypeInfo.app_name+"模板管理":""}}),a("div",{staticClass:"wyu-main"},[a("div",{staticClass:"wyu-tabbar"},[a("ul",[a("li",[a("router-link",{attrs:{to:"/miniapp/detail/"+t.apptype}},[t._v("程序首页")])],1),a("li",[a("router-link",{attrs:{to:"/miniapp/index/"+t.apptype}},[t._v("客户管理")])],1),a("li",{staticClass:"on"},[a("router-link",{attrs:{to:"/miniapp/template/"+t.apptype}},[t._v("模版管理")])],1),a("li",[a("router-link",{attrs:{to:"/miniapp/templatecat/"+t.apptype}},[t._v("模版分类")])],1),a("li",[a("router-link",{attrs:{to:"/miniapp/sms/"+t.apptype}},[t._v("短信模板")])],1)])]),a("div",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],staticClass:"wyu-block"},[a("el-form",{staticClass:"search-form",attrs:{"label-width":"80px",size:"mini",inline:!0},model:{value:t.searchForm,callback:function(e){t.searchForm=e},expression:"searchForm"}},[a("el-form-item",{attrs:{label:"名称"}},[a("el-input",{model:{value:t.searchForm.title,callback:function(e){t.$set(t.searchForm,"title",e)},expression:"searchForm.title"}})],1),a("el-form-item",{attrs:{label:"是否审核"}},[a("el-select",{attrs:{placeholder:"请选择"},model:{value:t.searchForm.audit,callback:function(e){t.$set(t.searchForm,"audit",e)},expression:"searchForm.audit"}},[a("el-option",{key:-999,attrs:{label:"请选择",value:-999}}),a("el-option",{key:0,attrs:{label:"未审核",value:0}}),a("el-option",{key:1,attrs:{label:"已审核",value:1}})],1)],1),a("el-form-item",{attrs:{label:"分类"}},[a("el-select",{attrs:{placeholder:"请选择"},model:{value:t.searchForm.cat_id,callback:function(e){t.$set(t.searchForm,"cat_id",e)},expression:"searchForm.cat_id"}},[a("el-option",{attrs:{label:"请选择",value:0}}),t._l(t.cats,function(t,e){return a("el-option",{key:e,attrs:{label:t.cat_name,value:t.cat_id}})})],2)],1),a("div",{staticStyle:{"padding-left":"80px"}},[a("el-button",{attrs:{icon:"el-icon-search",size:"mini",type:"primary"},on:{click:function(e){return t.getTemplateList(1)}}},[t._v("搜索")]),a("a",{attrs:{href:"javascript:void(0);"},on:{click:function(e){t.searchForm.title="",t.searchForm.cat_id=0,t.searchForm.audit=-999,t.getTemplateList(1)}}},[t._v("取消搜索")])],1)],1),a("el-dialog",{attrs:{title:"分类管理",visible:t.flDialog,"modal-append-to-body":!1,modal:!1,width:"600px"},on:{"update:visible":function(e){t.flDialog=e}}}),a("el-table",{ref:"multipleTable",attrs:{data:t.datas.list},on:{"selection-change":t.handleSelectionChange}},[a("el-table-column",{attrs:{type:"selection",width:"55"}}),a("el-table-column",{attrs:{prop:"template_id",label:"ID"}}),a("el-table-column",{attrs:{label:"缩略图"},scopedSlots:t._u([{key:"default",fn:function(t){return[a("img",{attrs:{src:t.row.photo,width:"80px;"}})]}}])}),a("el-table-column",{attrs:{prop:"title",label:"名称"}}),a("el-table-column",{attrs:{prop:"cat_name",label:"分类"}}),a("el-table-column",{attrs:{label:"是否已审核"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v("\n            "+t._s(e.row.audit?"已审核":"未审核")+"\n          ")]}}])}),a("el-table-column",{attrs:{label:"操作"},scopedSlots:t._u([{key:"default",fn:function(e){return[0==e.row.audit?a("el-button",{attrs:{size:"mini",type:"text"},on:{click:function(a){return t.auditTemplate(e)}}},[t._v("审核")]):t._e(),1==e.row.audit?a("el-button",{attrs:{size:"mini",type:"text"},on:{click:function(a){return t.auditTemplate(e)}}},[t._v("预览")]):t._e(),t._v("\n             \n\n            "),a("el-popover",{staticStyle:{margin:"0 10px"},attrs:{placement:"top",width:"160"},model:{value:e.row.is_delete,callback:function(a){t.$set(e.row,"is_delete",a)},expression:"scope.row.is_delete"}},[a("p",{staticStyle:{"margin-bottom":"4px"}},[t._v("确定删除吗？")]),a("div",{staticStyle:{"text-align":"right",margin:"0"}},[a("el-button",{attrs:{loading:t.loading,size:"mini",type:"text"},on:{click:function(t){e.row.is_delete=!1}}},[t._v("取消\n                ")]),a("el-button",{attrs:{loading:t.loading,type:"primary",size:"mini"},on:{click:function(a){return t.deleteTemplate(e)}}},[t._v("确定\n                ")])],1),a("el-button",{attrs:{slot:"reference",type:"text"},slot:"reference"},[t._v("删除")])],1)]}}])})],1),a("el-dialog",{attrs:{title:"预览模版",visible:t.dialog,"modal-append-to-body":!1,modal:!1,width:"600px"},on:{"update:visible":function(e){t.dialog=e}}},[""!=t.detail?a("el-form",{attrs:{size:"mini","label-width":"80px"}},[a("el-form-item",{attrs:{label:"模版名称"}},[a("el-input",{attrs:{placeholder:""},model:{value:t.detail.title,callback:function(e){t.$set(t.detail,"title",e)},expression:"detail.title"}})],1),a("el-form-item",{attrs:{label:"上传图片"}},[a("wyu-upload",{attrs:{img:t.detail.photo},model:{value:t.detail.photo,callback:function(e){t.$set(t.detail,"photo",e)},expression:"detail.photo"}})],1),a("el-form-item",{attrs:{label:"扫码预览"}},[a("qrcode-vue",{attrs:{value:t.detail.url}})],1),a("el-form-item",{attrs:{label:"选择分类"}},[a("el-select",{attrs:{placeholder:""},model:{value:t.detail.cat_id,callback:function(e){t.$set(t.detail,"cat_id",e)},expression:"detail.cat_id"}},[a("el-option",{attrs:{value:0,label:"请选择"}}),t._l(t.cats,function(t,e){return a("el-option",{key:e,attrs:{label:t.cat_name,value:t.cat_id}})})],2)],1),a("el-form-item",{attrs:{label:"是否审核"}},[a("el-switch",{attrs:{"active-value":1,"inactive-value":0},model:{value:t.detail.audit,callback:function(e){t.$set(t.detail,"audit",e)},expression:"detail.audit"}})],1),a("el-form-item",[a("el-button",{attrs:{type:"primary",loading:t.detailLoading},on:{click:t.onSave}},[t._v("立刻保存")])],1)],1):t._e()],1),a("div",{staticClass:"page"},[a("div",{staticClass:"page-tool"},[a("el-button",{attrs:{icon:"el-icon-delete",size:"mini",type:"danger"},on:{click:function(e){return t.deleteTemplate()}}},[t._v("批量删除")])],1),a("div",{staticClass:"page-mian"},[a("el-pagination",{attrs:{"page-size":t.datas.limit,layout:"total, prev, pager, next",total:t.datas.count},on:{"current-change":t.getTemplateList}})],1)])],1)])],1)},l=[],o=a("f499"),n=a.n(o),s=(a("ac6a"),a("a481"),a("5200")),r=a("d722"),c=a("5fed"),d=a("d7b0"),p="https://www.woyaou.com/api/",u={name:"adminRole",components:{TopNav:s["a"],WyuUpload:c["a"],QrcodeVue:d["a"]},data:function(){return{flDialog:!1,apptype:0,loading:!1,datas:[],is_delete:!1,searchForm:{title:"",type:"",cat_id:0,audit:""},cats:[],detail:[],detailLoading:!1,appTypeInfo:[],dialog:!1,templateId:0,templateIds:[]}},created:function(){this.apptype=this.$route.params.apptype,this.apptype?this.initWyu():this.$router.replace("/404")},methods:{initWyu:function(){var t=this;r["a"](p+"account/checkApp",{account_id:this.$store.getters.adminInfo.account.account_id,account_t:this.$store.getters.adminInfo.account.account_t,account_sign:this.$store.getters.adminInfo.account.account_sign,app_id:this.apptype}).then(function(e){t.getCats(),t.getTemplateList()}).catch(function(e){t.$router.replace("/buyauth")})},handleSelectionChange:function(t){var e=this;this.templateIds=[],t.forEach(function(t,a){e.templateIds.push(t.template_id)})},getCats:function(){var t=this;r["a"]("/admin/resource.template/allCats",{token:this.$store.getters.adminToken,app_type:this.apptype}).then(function(e){t.cats=e.cats}).catch(function(t){})},getTemplateList:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;this.loading=!0,r["a"]("/admin/resource.template/index",{token:this.$store.getters.adminToken,page:e,title:this.searchForm.title,app_type:this.apptype,cat_id:this.searchForm.cat_id,audit:this.searchForm.audit}).then(function(e){t.datas=e,t.loading=!1}).catch(function(e){t.loading=!1})},auditTemplate:function(t){this.detail=t.row,this.dialog=!0},onSave:function(){var t=this;this.detailLoading=!0,r["a"]("/admin/resource.template/edit",{token:this.$store.getters.adminToken,template_id:this.detail.template_id,cat_id:this.detail.cat_id,title:this.detail.title,photo:this.detail.photo,audit:this.detail.audit}).then(function(e){t.getTemplateList(),t.detailLoading=!1,t.dialog=!1,t.$message({message:"恭喜你，操作成功",type:"success"})}).catch(function(e){t.detailLoading=!1})},deleteTemplate:function(t){var e=this;this.is_delete=!1,this.loading=!0,t&&(t.row.is_delete=!1,this.templateId=t.row.template_id),r["a"]("/admin/resource.template/delete",{token:this.$store.getters.adminToken,template_id:this.templateId,templateIds:n()(this.templateIds)}).then(function(t){e.getTemplateList(),e.loading=!1,e.$message({message:"恭喜你，操作成功",type:"success"})}).catch(function(t){e.loading=!1})}}},m=u,h=a("2877"),f=Object(h["a"])(m,i,l,!1,null,null,null);e["default"]=f.exports},ac6a:function(t,e,a){for(var i=a("cadf"),l=a("0d58"),o=a("2aba"),n=a("7726"),s=a("32e9"),r=a("84f2"),c=a("2b4c"),d=c("iterator"),p=c("toStringTag"),u=r.Array,m={CSSRuleList:!0,CSSStyleDeclaration:!1,CSSValueList:!1,ClientRectList:!1,DOMRectList:!1,DOMStringList:!1,DOMTokenList:!0,DataTransferItemList:!1,FileList:!1,HTMLAllCollection:!1,HTMLCollection:!1,HTMLFormElement:!1,HTMLSelectElement:!1,MediaList:!0,MimeTypeArray:!1,NamedNodeMap:!1,NodeList:!0,PaintRequestList:!1,Plugin:!1,PluginArray:!1,SVGLengthList:!1,SVGNumberList:!1,SVGPathSegList:!1,SVGPointList:!1,SVGStringList:!1,SVGTransformList:!1,SourceBufferList:!1,StyleSheetList:!0,TextTrackCueList:!1,TextTrackList:!1,TouchList:!1},h=l(m),f=0;f<h.length;f++){var g,v=h[f],_=m[v],b=n[v],y=b&&b.prototype;if(y&&(y[d]||s(y,d,u),y[p]||s(y,p,v),r[v]=u,_))for(g in i)y[g]||o(y,g,i[g],!0)}}}]);
//# sourceMappingURL=chunk-0456df56.c5df5f52.js.map